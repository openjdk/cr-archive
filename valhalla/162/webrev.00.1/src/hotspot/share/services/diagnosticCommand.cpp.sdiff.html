<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/hotspot/share/services/diagnosticCommand.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="../runtime/vmOperations.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../utilities/growableArray.hpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/share/services/diagnosticCommand.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  79   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VersionDCmd&gt;(full_export, true, false));
  80   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CommandLineDCmd&gt;(full_export, true, false));
  81   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintSystemPropertiesDCmd&gt;(full_export, true, false));
  82   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintVMFlagsDCmd&gt;(full_export, true, false));
  83   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SetVMFlagDCmd&gt;(full_export, true, false));
  84   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMDynamicLibrariesDCmd&gt;(full_export, true, false));
  85   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMUptimeDCmd&gt;(full_export, true, false));
  86   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMInfoDCmd&gt;(full_export, true, false));
  87   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemGCDCmd&gt;(full_export, true, false));
  88   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;RunFinalizationDCmd&gt;(full_export, true, false));
  89   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapInfoDCmd&gt;(full_export, true, false));
  90   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;FinalizerInfoDCmd&gt;(full_export, true, false));
  91 #if INCLUDE_SERVICES
  92   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapDumpDCmd&gt;(DCmd_Source_Internal | DCmd_Source_AttachAPI, true, false));
  93   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHistogramDCmd&gt;(full_export, true, false));
  94   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemDictionaryDCmd&gt;(full_export, true, false));
  95   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHierarchyDCmd&gt;(full_export, true, false));
  96   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SymboltableDCmd&gt;(full_export, true, false));
  97   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;StringtableDCmd&gt;(full_export, true, false));
  98   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;metaspace::MetaspaceDCmd&gt;(full_export, true, false));

  99   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;EventLogDCmd&gt;(full_export, true, false));
 100 #if INCLUDE_JVMTI // Both JVMTI and SERVICES have to be enabled to have this dcmd
 101   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIAgentLoadDCmd&gt;(full_export, true, false));
 102 #endif // INCLUDE_JVMTI
 103 #endif // INCLUDE_SERVICES
 104 #if INCLUDE_JVMTI
 105   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIDataDumpDCmd&gt;(full_export, true, false));
 106 #endif // INCLUDE_JVMTI
 107   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ThreadDumpDCmd&gt;(full_export, true, false));
 108   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderStatsDCmd&gt;(full_export, true, false));
 109   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderHierarchyDCmd&gt;(full_export, true, false));
 110   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompileQueueDCmd&gt;(full_export, true, false));
 111   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeListDCmd&gt;(full_export, true, false));
 112   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeCacheDCmd&gt;(full_export, true, false));
 113   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;TouchedMethodsDCmd&gt;(full_export, true, false));
 114   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeHeapAnalyticsDCmd&gt;(full_export, true, false));
 115 
 116   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesPrintDCmd&gt;(full_export, true, false));
 117   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesAddDCmd&gt;(full_export, true, false));
 118   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesRemoveDCmd&gt;(full_export, true, false));
 119   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesClearDCmd&gt;(full_export, true, false));
 120 
 121   // Enhanced JMX Agent Support
 122   // These commands won&#39;t be exported via the DiagnosticCommandMBean until an
 123   // appropriate permission is created for them
 124   uint32_t jmx_agent_export_flags = DCmd_Source_Internal | DCmd_Source_AttachAPI;
 125   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 126   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartLocalDCmd&gt;(jmx_agent_export_flags, true,false));
 127   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStopRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 128   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStatusDCmd&gt;(jmx_agent_export_flags, true,false));
<span class="line-removed"> 129 </span>
 130   // Debug on cmd (only makes sense with JVMTI since the agentlib needs it).
 131 #if INCLUDE_JVMTI
 132   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;DebugOnCmdStartDCmd&gt;(full_export, true, true));
 133 #endif // INCLUDE_JVMTI
 134 
 135 }
 136 
 137 #ifndef HAVE_EXTRA_DCMD
 138 void DCmdRegistrant::register_dcmds_ext(){
 139    // Do nothing here
 140 }
 141 #endif
 142 
 143 
 144 HelpDCmd::HelpDCmd(outputStream* output, bool heap) : DCmdWithParser(output, heap),
 145   _all(&quot;-all&quot;, &quot;Show help for all commands&quot;, &quot;BOOLEAN&quot;, false, &quot;false&quot;),
 146   _cmd(&quot;command name&quot;, &quot;The name of the command for which we want help&quot;,
 147         &quot;STRING&quot;, false) {
 148   _dcmdparser.add_dcmd_option(&amp;_all);
 149   _dcmdparser.add_dcmd_argument(&amp;_cmd);
</pre>
<hr />
<pre>
1012 
1013 void ClassHierarchyDCmd::execute(DCmdSource source, TRAPS) {
1014   VM_PrintClassHierarchy printClassHierarchyOp(output(), _print_interfaces.value(),
1015                                                _print_subclasses.value(), _classname.value());
1016   VMThread::execute(&amp;printClassHierarchyOp);
1017 }
1018 
1019 int ClassHierarchyDCmd::num_arguments() {
1020   ResourceMark rm;
1021   ClassHierarchyDCmd* dcmd = new ClassHierarchyDCmd(NULL, false);
1022   if (dcmd != NULL) {
1023     DCmdMark mark(dcmd);
1024     return dcmd-&gt;_dcmdparser.num_arguments();
1025   } else {
1026     return 0;
1027   }
1028 }
1029 
1030 #endif
1031 























1032 class VM_DumpTouchedMethods : public VM_Operation {
1033 private:
1034   outputStream* _out;
1035 public:
1036   VM_DumpTouchedMethods(outputStream* out) {
1037     _out = out;
1038   }
1039 
1040   virtual VMOp_Type type() const { return VMOp_DumpTouchedMethods; }
1041 
1042   virtual void doit() {
1043     Method::print_touched_methods(_out);
1044   }
1045 };
1046 
1047 TouchedMethodsDCmd::TouchedMethodsDCmd(outputStream* output, bool heap) :
1048                                        DCmdWithParser(output, heap)
1049 {}
1050 
1051 void TouchedMethodsDCmd::execute(DCmdSource source, TRAPS) {
</pre>
</td>
<td>
<hr />
<pre>
  79   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VersionDCmd&gt;(full_export, true, false));
  80   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CommandLineDCmd&gt;(full_export, true, false));
  81   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintSystemPropertiesDCmd&gt;(full_export, true, false));
  82   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintVMFlagsDCmd&gt;(full_export, true, false));
  83   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SetVMFlagDCmd&gt;(full_export, true, false));
  84   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMDynamicLibrariesDCmd&gt;(full_export, true, false));
  85   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMUptimeDCmd&gt;(full_export, true, false));
  86   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;VMInfoDCmd&gt;(full_export, true, false));
  87   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemGCDCmd&gt;(full_export, true, false));
  88   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;RunFinalizationDCmd&gt;(full_export, true, false));
  89   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapInfoDCmd&gt;(full_export, true, false));
  90   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;FinalizerInfoDCmd&gt;(full_export, true, false));
  91 #if INCLUDE_SERVICES
  92   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;HeapDumpDCmd&gt;(DCmd_Source_Internal | DCmd_Source_AttachAPI, true, false));
  93   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHistogramDCmd&gt;(full_export, true, false));
  94   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SystemDictionaryDCmd&gt;(full_export, true, false));
  95   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassHierarchyDCmd&gt;(full_export, true, false));
  96   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;SymboltableDCmd&gt;(full_export, true, false));
  97   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;StringtableDCmd&gt;(full_export, true, false));
  98   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;metaspace::MetaspaceDCmd&gt;(full_export, true, false));
<span class="line-added">  99   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;PrintClassLayoutDCmd&gt;(full_export, true, false));</span>
 100   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;EventLogDCmd&gt;(full_export, true, false));
 101 #if INCLUDE_JVMTI // Both JVMTI and SERVICES have to be enabled to have this dcmd
 102   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIAgentLoadDCmd&gt;(full_export, true, false));
 103 #endif // INCLUDE_JVMTI
 104 #endif // INCLUDE_SERVICES
 105 #if INCLUDE_JVMTI
 106   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JVMTIDataDumpDCmd&gt;(full_export, true, false));
 107 #endif // INCLUDE_JVMTI
 108   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ThreadDumpDCmd&gt;(full_export, true, false));
 109   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderStatsDCmd&gt;(full_export, true, false));
 110   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;ClassLoaderHierarchyDCmd&gt;(full_export, true, false));
 111   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompileQueueDCmd&gt;(full_export, true, false));
 112   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeListDCmd&gt;(full_export, true, false));
 113   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeCacheDCmd&gt;(full_export, true, false));
 114   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;TouchedMethodsDCmd&gt;(full_export, true, false));
 115   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CodeHeapAnalyticsDCmd&gt;(full_export, true, false));
 116 
 117   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesPrintDCmd&gt;(full_export, true, false));
 118   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesAddDCmd&gt;(full_export, true, false));
 119   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesRemoveDCmd&gt;(full_export, true, false));
 120   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;CompilerDirectivesClearDCmd&gt;(full_export, true, false));
 121 
 122   // Enhanced JMX Agent Support
 123   // These commands won&#39;t be exported via the DiagnosticCommandMBean until an
 124   // appropriate permission is created for them
 125   uint32_t jmx_agent_export_flags = DCmd_Source_Internal | DCmd_Source_AttachAPI;
 126   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 127   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStartLocalDCmd&gt;(jmx_agent_export_flags, true,false));
 128   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStopRemoteDCmd&gt;(jmx_agent_export_flags, true,false));
 129   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;JMXStatusDCmd&gt;(jmx_agent_export_flags, true,false));

 130   // Debug on cmd (only makes sense with JVMTI since the agentlib needs it).
 131 #if INCLUDE_JVMTI
 132   DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl&lt;DebugOnCmdStartDCmd&gt;(full_export, true, true));
 133 #endif // INCLUDE_JVMTI
 134 
 135 }
 136 
 137 #ifndef HAVE_EXTRA_DCMD
 138 void DCmdRegistrant::register_dcmds_ext(){
 139    // Do nothing here
 140 }
 141 #endif
 142 
 143 
 144 HelpDCmd::HelpDCmd(outputStream* output, bool heap) : DCmdWithParser(output, heap),
 145   _all(&quot;-all&quot;, &quot;Show help for all commands&quot;, &quot;BOOLEAN&quot;, false, &quot;false&quot;),
 146   _cmd(&quot;command name&quot;, &quot;The name of the command for which we want help&quot;,
 147         &quot;STRING&quot;, false) {
 148   _dcmdparser.add_dcmd_option(&amp;_all);
 149   _dcmdparser.add_dcmd_argument(&amp;_cmd);
</pre>
<hr />
<pre>
1012 
1013 void ClassHierarchyDCmd::execute(DCmdSource source, TRAPS) {
1014   VM_PrintClassHierarchy printClassHierarchyOp(output(), _print_interfaces.value(),
1015                                                _print_subclasses.value(), _classname.value());
1016   VMThread::execute(&amp;printClassHierarchyOp);
1017 }
1018 
1019 int ClassHierarchyDCmd::num_arguments() {
1020   ResourceMark rm;
1021   ClassHierarchyDCmd* dcmd = new ClassHierarchyDCmd(NULL, false);
1022   if (dcmd != NULL) {
1023     DCmdMark mark(dcmd);
1024     return dcmd-&gt;_dcmdparser.num_arguments();
1025   } else {
1026     return 0;
1027   }
1028 }
1029 
1030 #endif
1031 
<span class="line-added">1032 PrintClassLayoutDCmd::PrintClassLayoutDCmd(outputStream* output, bool heap) :</span>
<span class="line-added">1033                                        DCmdWithParser(output, heap),</span>
<span class="line-added">1034   _classname(&quot;classname&quot;, &quot;Name of class whose layout should be printed. &quot;,</span>
<span class="line-added">1035              &quot;STRING&quot;, true) {</span>
<span class="line-added">1036   _dcmdparser.add_dcmd_argument(&amp;_classname);</span>
<span class="line-added">1037 }</span>
<span class="line-added">1038 </span>
<span class="line-added">1039 void PrintClassLayoutDCmd::execute(DCmdSource source, TRAPS) {</span>
<span class="line-added">1040   VM_PrintClassLayout printClassLayoutOp(output(), _classname.value());</span>
<span class="line-added">1041   VMThread::execute(&amp;printClassLayoutOp);</span>
<span class="line-added">1042 }</span>
<span class="line-added">1043 </span>
<span class="line-added">1044 int PrintClassLayoutDCmd::num_arguments() {</span>
<span class="line-added">1045   ResourceMark rm;</span>
<span class="line-added">1046   PrintClassLayoutDCmd* dcmd = new PrintClassLayoutDCmd(NULL, false);</span>
<span class="line-added">1047   if (dcmd != NULL) {</span>
<span class="line-added">1048     DCmdMark mark(dcmd);</span>
<span class="line-added">1049     return dcmd-&gt;_dcmdparser.num_arguments();</span>
<span class="line-added">1050   } else {</span>
<span class="line-added">1051     return 0;</span>
<span class="line-added">1052   }</span>
<span class="line-added">1053 }</span>
<span class="line-added">1054 </span>
1055 class VM_DumpTouchedMethods : public VM_Operation {
1056 private:
1057   outputStream* _out;
1058 public:
1059   VM_DumpTouchedMethods(outputStream* out) {
1060     _out = out;
1061   }
1062 
1063   virtual VMOp_Type type() const { return VMOp_DumpTouchedMethods; }
1064 
1065   virtual void doit() {
1066     Method::print_touched_methods(_out);
1067   }
1068 };
1069 
1070 TouchedMethodsDCmd::TouchedMethodsDCmd(outputStream* output, bool heap) :
1071                                        DCmdWithParser(output, heap)
1072 {}
1073 
1074 void TouchedMethodsDCmd::execute(DCmdSource source, TRAPS) {
</pre>
</td>
</tr>
</table>
<center><a href="../runtime/vmOperations.hpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../utilities/growableArray.hpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>