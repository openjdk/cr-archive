<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff test/hotspot/jtreg/compiler/valhalla/inlinetypes/TestMethodHandles.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="TestLWorldProfiling.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestNullableArrays.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>test/hotspot/jtreg/compiler/valhalla/inlinetypes/TestMethodHandles.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 290,16 ***</span>
  
      // Similar as above but with the method handle for target1 not
      // constant. Shouldn&#39;t cause any allocation.
      @ForceInline
      static MyValue2 test7_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI, true);</span>
      }
  
      @ForceInline
      static MyValue2 test7_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+1, false);</span>
      }
  
      static boolean test7_bool = true;
      @ForceInline
      static boolean test7_test() {
<span class="line-new-header">--- 290,16 ---</span>
  
      // Similar as above but with the method handle for target1 not
      // constant. Shouldn&#39;t cause any allocation.
      @ForceInline
      static MyValue2 test7_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI, rD);</span>
      }
  
      @ForceInline
      static MyValue2 test7_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+1, rD+1);</span>
      }
  
      static boolean test7_bool = true;
      @ForceInline
      static boolean test7_test() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 316,23 ***</span>
  
      @DontCompile
      public void test7_verifier(boolean warmup) throws Throwable {
          test7_bool = !test7_bool;
          long hash = test7();
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(rI+(test7_bool ? 0 : 1), test7_bool).hash());</span>
      }
  
      // Same as above but with the method handle for target2 not
      // constant. Shouldn&#39;t cause any allocation.
      @ForceInline
      static MyValue2 test8_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI, true);</span>
      }
  
      @ForceInline
      static MyValue2 test8_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+1, false);</span>
      }
  
      static boolean test8_bool = true;
      @ForceInline
      static boolean test8_test() {
<span class="line-new-header">--- 316,23 ---</span>
  
      @DontCompile
      public void test7_verifier(boolean warmup) throws Throwable {
          test7_bool = !test7_bool;
          long hash = test7();
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(rI+(test7_bool ? 0 : 1), rD+(test7_bool ? 0 : 1)).hash());</span>
      }
  
      // Same as above but with the method handle for target2 not
      // constant. Shouldn&#39;t cause any allocation.
      @ForceInline
      static MyValue2 test8_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI, rD);</span>
      }
  
      @ForceInline
      static MyValue2 test8_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+1, rD+1);</span>
      }
  
      static boolean test8_bool = true;
      @ForceInline
      static boolean test8_test() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 349,11 ***</span>
  
      @DontCompile
      public void test8_verifier(boolean warmup) throws Throwable {
          test8_bool = !test8_bool;
          long hash = test8();
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(rI+(test8_bool ? 0 : 1), test8_bool).hash());</span>
      }
  
      // Return of target1, target2 and target3 merged in Lambda Forms
      // as an Object. Shouldn&#39;t cause any allocation
      final MyValue3 test9_vt1 = MyValue3.create();
<span class="line-new-header">--- 349,11 ---</span>
  
      @DontCompile
      public void test8_verifier(boolean warmup) throws Throwable {
          test8_bool = !test8_bool;
          long hash = test8();
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(rI+(test8_bool ? 0 : 1), rD+(test8_bool ? 0 : 1)).hash());</span>
      }
  
      // Return of target1, target2 and target3 merged in Lambda Forms
      // as an Object. Shouldn&#39;t cause any allocation
      final MyValue3 test9_vt1 = MyValue3.create();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 405,21 ***</span>
      }
  
      // Same as above but with non constant target2 and target3
      @ForceInline
      static MyValue2 test10_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI, true);</span>
      }
  
      @ForceInline
      static MyValue2 test10_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+1, false);</span>
      }
  
      @ForceInline
      static MyValue2 test10_target3() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+2, true);</span>
      }
  
      static boolean test10_bool1 = true;
      @ForceInline
      static boolean test10_test1() {
<span class="line-new-header">--- 405,21 ---</span>
      }
  
      // Same as above but with non constant target2 and target3
      @ForceInline
      static MyValue2 test10_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI, rD);</span>
      }
  
      @ForceInline
      static MyValue2 test10_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+1, rD+1);</span>
      }
  
      @ForceInline
      static MyValue2 test10_target3() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+2, rD+2);</span>
      }
  
      static boolean test10_bool1 = true;
      @ForceInline
      static boolean test10_test1() {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 447,25 ***</span>
      public void test10_verifier(boolean warmup) throws Throwable {
          test10_i++;
          test10_bool1 = (test10_i % 2) == 0;
          test10_bool2 = (test10_i % 3) == 0;
          long hash = test10();
<span class="line-modified">!         int i = rI+(test10_bool1 ? 0 : (test10_bool2 ? 1 : 2));</span>
<span class="line-modified">!         boolean b = test10_bool1 ? true : (test10_bool2 ? false : true);</span>
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(i, b).hash());</span>
      }
  
      static int test11_i = 0;
  
      @ForceInline
      static MyValue2 test11_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+test11_i, true);</span>
      }
  
      @ForceInline
      static MyValue2 test11_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI-test11_i, false);</span>
      }
  
      @ForceInline
      static boolean test11_test() {
          return (test11_i % 100) == 0;
<span class="line-new-header">--- 447,25 ---</span>
      public void test10_verifier(boolean warmup) throws Throwable {
          test10_i++;
          test10_bool1 = (test10_i % 2) == 0;
          test10_bool2 = (test10_i % 3) == 0;
          long hash = test10();
<span class="line-modified">!         int i = rI + (test10_bool1 ? 0 : (test10_bool2 ? 1 : 2));</span>
<span class="line-modified">!         double d = rD + (test10_bool1 ? 0 : (test10_bool2 ? 1 : 2));</span>
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(i, d).hash());</span>
      }
  
      static int test11_i = 0;
  
      @ForceInline
      static MyValue2 test11_target1() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI+test11_i, rD+test11_i);</span>
      }
  
      @ForceInline
      static MyValue2 test11_target2() {
<span class="line-modified">!         return MyValue2.createWithFieldsInline(rI-test11_i, rD-test11_i);</span>
      }
  
      @ForceInline
      static boolean test11_test() {
          return (test11_i % 100) == 0;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 485,8 ***</span>
      @DontCompile
      public void test11_verifier(boolean warmup) throws Throwable {
          test11_i++;
          long hash = test11();
          boolean b = (test11_i % 100) == 0;
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(rI+test11_i * (b ? 1 : -1), b).hash());</span>
      }
  }
<span class="line-new-header">--- 485,8 ---</span>
      @DontCompile
      public void test11_verifier(boolean warmup) throws Throwable {
          test11_i++;
          long hash = test11();
          boolean b = (test11_i % 100) == 0;
<span class="line-modified">!         Asserts.assertEQ(hash, MyValue2.createWithFieldsInline(rI+test11_i * (b ? 1 : -1), rD+test11_i * (b ? 1 : -1)).hash());</span>
      }
  }
</pre>
<center><a href="TestLWorldProfiling.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="TestNullableArrays.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>