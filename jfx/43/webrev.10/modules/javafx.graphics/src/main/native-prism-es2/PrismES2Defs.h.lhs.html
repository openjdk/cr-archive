<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.graphics/src/main/native-prism-es2/PrismES2Defs.h</title>
    <link rel="stylesheet" href="../../../../../style.css" />
    <script type="text/javascript" src="../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /*
<a name="1" id="anc1"></a><span class="line-modified">  2  * Copyright (c) 2012, 2016, Oracle and/or its affiliates. All rights reserved.</span>
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 #ifndef _Prism_es2_defs_h_
 27 #define _Prism_es2_defs_h_
 28 
 29 #if defined(SOLARIS) || defined(LINUX) || defined(ANDROID_NDK) /* SOLARIS || LINUX */
 30 #define GLX_GLEXT_PROTOTYPES
 31 #define GLX_GLXEXT_PROTOTYPES
 32 #define UNIX
 33 #if defined(IS_EGLX11) || defined(IS_EGLFB)
 34 #define IS_EGL
 35 #else
 36 #define IS_GLX
 37 #endif
 38 
 39 #include &lt;limits.h&gt;
 40 
 41 #ifndef ANDROID_NDK
 42 #include &lt;X11/X.h&gt;
 43 #include &lt;X11/Xlib.h&gt;
 44 #include &lt;X11/Xutil.h&gt;
 45 #include &lt;GL/glx.h&gt;
 46 #endif
 47 
 48 #include &lt;GL/gl.h&gt;
 49 #include &lt;GL/glext.h&gt;
 50 
 51 #ifndef __USE_GNU
 52 #define __USE_GNU
 53 #endif
 54 #include &lt;dlfcn.h&gt;
 55 
 56 #define jlong_to_ptr(value) ((void*)((long)value))
 57 #define ptr_to_jlong(value) (jlong)((long)(value))
 58 
 59 /* Max lenght of value, attr pair plus a None */
 60 #define  MAX_GLX_ATTRS_LENGTH 50
 61 
 62 #ifdef IS_EGL
 63 #include &lt;EGL/egl.h&gt;
 64 #include &quot;eglWrapper/eglWrapper.h&quot;
 65 #endif
 66 
 67 #endif /* SOLARIS || LINUX */
 68 
 69 #ifdef __APPLE__
 70 #include &lt;TargetConditionals.h&gt;
 71 
 72 #define jlong_to_ptr(value) (intptr_t)(value)
 73 #define ptr_to_jlong(value) (jlong)((intptr_t)(value))
 74 
 75 #if TARGET_OS_IPHONE /* iOS */
 76 #include &lt;GL/gl.h&gt;
 77 #include &lt;GL/glext.h&gt;
 78 #include &quot;ios/ios-window-system.h&quot;
 79 #define IS_EGL
 80 
 81 #elif TARGET_OS_MAC /* MacOSX */
 82 /* Include the OpenGL headers */
 83 #include &lt;GL/gl.h&gt;
 84 #include &lt;GL/glext.h&gt;
 85 #include &lt;OpenGL/OpenGL.h&gt;
 86 #include &lt;OpenGL/CGLTypes.h&gt;
 87 #include &quot;macosx-window-system.h&quot;
 88 
 89 /* Max length of value, attr pair plus a None */
 90 #define MAX_PF_ATTRS_LENGTH 50
 91 #endif /* MacOSX */
 92 #endif /* __APPLE__ */
 93 
 94 #ifdef WIN32 /* WIN32 */
 95 #include &lt;windows.h&gt;
 96 #include &lt;GL/gl.h&gt;
 97 #include &lt;GL/wglext.h&gt;
 98 #include &lt;GL/glext.h&gt;
 99 
100 #ifndef _WIN32_WINNT
101 #define _WIN32_WINNT 0x0500
102 #endif
103 #ifndef _WIN64
104 typedef int intptr_t;
105 #endif
106 
107 #define jlong_to_ptr(value) (intptr_t)(value)
108 #define ptr_to_jlong(value) (jlong)((intptr_t)(value))
109 #endif /* WIN32 */
110 
111 /* platform independent .h files generated by javah */
112 #include &quot;com_sun_prism_es2_GLContext.h&quot;
113 #include &quot;com_sun_prism_es2_GLFactory.h&quot;
114 #include &quot;com_sun_prism_es2_GLPixelFormat_Attributes.h&quot;
115 
116 /*
117  * These match the constants in GLPixelFormat
118  */
119 #define RED_SIZE        com_sun_prism_es2_GLPixelFormat_Attributes_RED_SIZE
120 #define GREEN_SIZE      com_sun_prism_es2_GLPixelFormat_Attributes_GREEN_SIZE
121 #define BLUE_SIZE       com_sun_prism_es2_GLPixelFormat_Attributes_BLUE_SIZE
122 #define ALPHA_SIZE      com_sun_prism_es2_GLPixelFormat_Attributes_ALPHA_SIZE
123 #define DEPTH_SIZE      com_sun_prism_es2_GLPixelFormat_Attributes_DEPTH_SIZE
124 #define DOUBLEBUFFER    com_sun_prism_es2_GLPixelFormat_Attributes_DOUBLEBUFFER
125 #define ONSCREEN        com_sun_prism_es2_GLPixelFormat_Attributes_ONSCREEN
126 #define NUM_ITEMS       com_sun_prism_es2_GLPixelFormat_Attributes_NUM_ITEMS
127 
128 #ifdef ANDROID_NDK
129 
130 #include &quot;com_sun_prism_es2_GLPixelFormat_Attributes.h&quot;
131 
132 typedef EGLNativeDisplayType Display;
133 typedef EGLNativeWindowType  Window;
134 typedef EGLConfig            GLXFBConfig;
135 typedef unsigned long        Colormap;
136 typedef unsigned long        PFNGLXSWAPINTERVALSGIPROC;
137 
138 #include &lt;android/log.h&gt;
139 #include &lt;string.h&gt;
140 #define TAG &quot;javafx&quot;
141 #define printf(...) ((void)__android_log_print(ANDROID_LOG_INFO, TAG, __VA_ARGS__))
142 #define fprintf(IGNORE, ...) ((void)__android_log_print(ANDROID_LOG_ERROR, TAG, __VA_ARGS__))
143 #endif
144 
145 /* Typedef for pixelformat properties struct */
146 typedef struct PixelFormatInfoRec PixelFormatInfo;
147 
148 /* define the structure to hold the resources and proerties of pixelformat */
149 struct PixelFormatInfoRec {
150 #ifdef WIN32 /* WIN32 */
151     int pixelFormat;
152     HWND dummyHwnd;
153     HDC dummyHdc;
154     LPCTSTR dummySzAppName;
155 #endif /* WIN32 */
156 
157 #ifdef UNIX /* LINUX || SOLARIS */
158     Display *display;
159     GLXFBConfig fbConfig;
160     Window dummyWin;
161     Colormap dummyCmap;
162 #endif
163 
164 #ifdef MACOSX /* MACOSX */
165     jlong pixelFormat;
166 #endif
167 };
168 
169 /* Typedef for drawable properties struct */
170 typedef struct DrawableInfoRec DrawableInfo;
171 
172 /* define the structure to hold the resources and proerties of drawable */
173 struct DrawableInfoRec {
174     jboolean onScreen;
175 
176 #ifdef WIN32 /* WIN32 */
177     HDC hdc;
178     HWND hwnd;
179 #endif /* WIN32 */
180 
181 #ifdef UNIX /* LINUX || SOLARIS */
182 #ifdef IS_EGL
183     EGLDisplay *egldisplay;
184     EGLSurface eglsurface;
185 #endif
186 #ifndef IS_EGLFB
187     Display *display;
188     Window win;
189 #endif
190 #endif
191 
192 #ifdef __APPLE__
193     jlong win;
194 #endif /* __APPLE__ */
195 };
196 
197 /* Typedef for state properties struct */
198 typedef struct StateInfoRec StateInfo;
199 
200 /* define the structure to hold the states of context */
201 struct StateInfoRec {
202     /* For state caching */
203     jboolean depthWritesEnabled;
204     jboolean scissorEnabled;
205     GLclampf clearColor[4];
206     jboolean vSyncEnabled;
207 
208     /* For 3d state caching */
209     GLboolean cullEnable;
210     GLenum cullMode;
211     GLenum fillMode;
212 
213     /* Currently bound fbo */
214     GLuint fbo;
215 };
216 
217 /* Typedef for context properties struct */
218 typedef struct ContextInfoRec ContextInfo;
219 
220 /* define the structure to hold the properties of graphics context */
221 struct ContextInfoRec {
222 #ifdef WIN32 /* WIN32 */
223     HGLRC hglrc;
224 #endif /* WIN32 */
225 
226 #ifdef UNIX /* LINUX || SOLARIS */
227     Display *display;
228 #ifdef IS_EGL
229     EGLContext context;
230     EGLDisplay *egldisplay;
231     EGLSurface eglsurface;
232 #else
233      GLXContext context;
234 #endif
235 
236 #if defined(IS_GLX) || defined( IS_EGLX11)
237     /*
238      * display screen and visualID are cached
239      * for Factory to pass to Glass
240      */
241     int screen;
242     int visualID;
243 #endif
244 #endif
245 
246 #ifdef __APPLE__
247     jlong context;
248 #endif /* __APPLE__ */
249 
250     /* version and extension info */
251     char *versionStr;
252     char *vendorStr;
253     char *rendererStr;
254     char *glExtensionStr;
255     int versionNumbers[2];
256 
257     /* platform specific extension string and function pointers */
258 #ifdef WIN32 /* WIN32 */
259     char *wglExtensionStr;
260     PFNWGLSWAPINTERVALEXTPROC wglSwapIntervalEXT;
261 #endif /* WIN32 */
262 
263 #ifdef UNIX /* LINUX || SOLARIS */
264     char *glxExtensionStr;
265     PFNGLXSWAPINTERVALSGIPROC glXSwapIntervalSGI;
266 #endif /* LINUX || SOLARIS */
267 
268     /* gl function pointers */
269     PFNGLACTIVETEXTUREPROC glActiveTexture;
270     PFNGLATTACHSHADERPROC glAttachShader;
271     PFNGLBINDATTRIBLOCATIONPROC glBindAttribLocation;
272     PFNGLBINDFRAMEBUFFERPROC glBindFramebuffer;
273     PFNGLBINDRENDERBUFFERPROC glBindRenderbuffer;
274     PFNGLCHECKFRAMEBUFFERSTATUSPROC glCheckFramebufferStatus;
275     PFNGLCOMPILESHADERPROC glCompileShader;
276     PFNGLCREATEPROGRAMPROC glCreateProgram;
277     PFNGLCREATESHADERPROC glCreateShader;
278     PFNGLDELETEBUFFERSPROC glDeleteBuffers;
279     PFNGLDELETEFRAMEBUFFERSPROC glDeleteFramebuffers;
280     PFNGLDELETEPROGRAMPROC glDeleteProgram;
281     PFNGLDELETESHADERPROC glDeleteShader;
282     PFNGLDELETERENDERBUFFERSPROC glDeleteRenderbuffers;
283     PFNGLDETACHSHADERPROC glDetachShader;
284     PFNGLDISABLEVERTEXATTRIBARRAYPROC glDisableVertexAttribArray;
285     PFNGLENABLEVERTEXATTRIBARRAYPROC glEnableVertexAttribArray;
286     PFNGLFRAMEBUFFERRENDERBUFFERPROC glFramebufferRenderbuffer;
287     PFNGLFRAMEBUFFERTEXTURE2DPROC glFramebufferTexture2D;
288     PFNGLGENFRAMEBUFFERSPROC glGenFramebuffers;
289     PFNGLGENRENDERBUFFERSPROC glGenRenderbuffers;
290     PFNGLGETPROGRAMIVPROC glGetProgramiv;
291     PFNGLGETSHADERIVPROC glGetShaderiv;
292     PFNGLGETUNIFORMLOCATIONPROC glGetUniformLocation;
293     PFNGLLINKPROGRAMPROC glLinkProgram;
294     PFNGLRENDERBUFFERSTORAGEPROC glRenderbufferStorage;
295     PFNGLSHADERSOURCEPROC glShaderSource;
296     PFNGLGETSHADERINFOLOGPROC glGetShaderInfoLog;
297     PFNGLGETPROGRAMINFOLOGPROC glGetProgramInfoLog;
298     PFNGLBUFFERSUBDATAPROC glBufferSubData;
299     PFNGLUNIFORM1FPROC glUniform1f;
300     PFNGLUNIFORM2FPROC glUniform2f;
301     PFNGLUNIFORM3FPROC glUniform3f;
302     PFNGLUNIFORM4FPROC glUniform4f;
303     PFNGLUNIFORM4FVPROC glUniform4fv;
304     PFNGLUNIFORM1IPROC glUniform1i;
305     PFNGLUNIFORM2IPROC glUniform2i;
306     PFNGLUNIFORM3IPROC glUniform3i;
307     PFNGLUNIFORM4IPROC glUniform4i;
308     PFNGLUNIFORM4IVPROC glUniform4iv;
309     PFNGLUNIFORMMATRIX4FVPROC glUniformMatrix4fv;
310     PFNGLUSEPROGRAMPROC glUseProgram;
311     PFNGLVALIDATEPROGRAMPROC glValidateProgram;
312     PFNGLVERTEXATTRIBPOINTERPROC glVertexAttribPointer;
313 
314     PFNGLGENBUFFERSPROC glGenBuffers;
315     PFNGLBINDBUFFERPROC glBindBuffer;
316     PFNGLBUFFERDATAPROC glBufferData;
317     PFNGLTEXIMAGE2DMULTISAMPLEPROC glTexImage2DMultisample;
318     PFNGLRENDERBUFFERSTORAGEMULTISAMPLEPROC glRenderbufferStorageMultisample;
319     PFNGLBLITFRAMEBUFFERPROC glBlitFramebuffer;
320 
321     /* For state caching */
322     StateInfo state;
323 
324     /* this pointers represent cached values of glVertexAttribPointer values */
325     /* they should be properly updated in case of glVertexAttribPointer call */
326     /* see setVertexAttributePointers */
327     float *vbFloatData;
328     char  *vbByteData;
329     jboolean gl2;
330 
331     /* Caching properties passed down from Java */
332     jboolean vSyncRequested;
333 };
334 
335 // extern declarations for core functions
336 extern int isExtensionSupported(const char *allExtensions, const char *extension);
337 extern void extractVersionInfo(char *versionStr, int *numbers);
338 extern void initializeCtxInfo(ContextInfo *ctxInfo);
339 extern void initializePixelFormatInfo(PixelFormatInfo *pfInfo);
340 extern void initState(ContextInfo *ctxInfo);
341 extern void deletePixelFormatInfo(PixelFormatInfo *pfInfo);
342 
343 /* Define 3D Primitive data type */
344 /* define constants and structures to hold the resources of 3D primitive and rendering
345  * attributes */
346 #define VC_3D_INDEX 0
347 #define TC_3D_INDEX 1
348 #define NC_3D_INDEX 2
349 #define VC_3D_SIZE 3  /* x, y, z */
350 #define TC_3D_SIZE 2  /* tu, tv */
351 #define NC_3D_SIZE 4  /* nx, ny, nz, nw */
352 #define VERT_3D_SIZE (VC_3D_SIZE + TC_3D_SIZE + NC_3D_SIZE)
353 #define VERT_3D_STRIDE (sizeof(GLfloat) * VERT_3D_SIZE)
354 
355 #define MESH_VERTEXBUFFER 0
356 #define MESH_INDEXBUFFER 1
357 #define MESH_MAX_BUFFERS 2
358 
359 typedef struct MeshInfoRec MeshInfo;
360 struct MeshInfoRec {
361     // vboIDArray[MESH_VERTEXBUFFER] used to store interleave points and tex. coords.
362     // vboIDArray[MESH_INDEXBUFFER] used to store element indices
363     GLuint vboIDArray[MESH_MAX_BUFFERS];
364     GLuint indexBufferSize;
365     GLenum indexBufferType;
366 };
367 
368 typedef struct PhongMaterialInfoRec PhongMaterialInfo;
369 struct PhongMaterialInfoRec {
370    GLfloat diffuseColor[4]; // in the order of rgba
371    GLuint maps[4];
372 };
373 
374 typedef struct MeshViewInfoRec MeshViewInfo;
375 struct MeshViewInfoRec {
376     MeshInfo *meshInfo;
377     PhongMaterialInfo *phongMaterialInfo;
378     GLfloat ambientLightColor[3];
379     GLuint pointLightIndex;
380     GLfloat pointLightWeight;
381     GLfloat pointLightPosition[3];
382     GLfloat pointLightColor[3];
<a name="2" id="anc2"></a>

383     GLboolean cullEnable;
384     GLenum cullMode;
385     GLenum fillMode;
386 };
387 
388 /*
389  * General purpose assertion macro
390  */
391 #define PRISMES2_ASSERT(expr) \
392     if (!(expr)) { \
393         fprintf(stderr, \
394             &quot;\nAssertion failed in module &#39;%s&#39; at line %d\n&quot;, \
395             __FILE__, __LINE__); \
396         fprintf(stderr, &quot;\t%s\n\n&quot;, #expr);     \
397     }
398 
399 #endif /* _Prism_es2_defs_h_ */
<a name="3" id="anc3"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="3" type="hidden" />
</body>
</html>