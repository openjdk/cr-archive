<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff agent/src/test/java/org/openjdk/jmc/agent/test/TestRetrieveEventProbes.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../main/java/org/openjdk/jmc/agent/jmx/AgentControllerMXBean.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>agent/src/test/java/org/openjdk/jmc/agent/test/TestRetrieveEventProbes.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
50 			+ &quot;&lt;events&gt;&quot;
51 			+ &quot;&lt;event id=\&quot;demo.jfr.test1\&quot;&gt;&quot;
52 			+ &quot;&lt;name&gt;JFR Hello World Event 1 &lt;/name&gt;&quot;
53 			+ &quot;&lt;description&gt;Defined in the xml file and added by the agent.&lt;/description&gt;&quot;
54 			+ &quot;&lt;path&gt;demo/jfrhelloworldevent1&lt;/path&gt;&quot;
55 			+ &quot;&lt;stacktrace&gt;true&lt;/stacktrace&gt;&quot;
56 			+ &quot;&lt;class&gt;org.openjdk.jmc.agent.test.InstrumentMe&lt;/class&gt;&quot;
57 			+ &quot;&lt;method&gt;&quot;
58 			+ &quot;&lt;name&gt;printHelloWorldJFR1&lt;/name&gt;&quot;
59 			+ &quot;&lt;descriptor&gt;()V&lt;/descriptor&gt;&quot;
60 			+ &quot;&lt;/method&gt;&quot;
61 			+ &quot;&lt;location&gt;WRAP&lt;/location&gt;&quot;
62 			+ &quot;&lt;/event&gt;&quot;
63 			+ &quot;&lt;/events&gt;&quot;
64 			+ &quot;&lt;/jfragent&gt;&quot;;
65 	@Test
66 	public void testRetrieveEventProbes() throws Exception {
67 		AgentControllerMXBean mbean = JMX.newMXBeanProxy(ManagementFactory.getPlatformMBeanServer(),
68 				new ObjectName(AGENT_OBJECT_NAME), AgentControllerMXBean.class, false);
69 
<span class="line-modified">70 		Assert.assertTrue(mbean.retrieveEventProbes().isEmpty());</span>
71 		mbean.defineEventProbes(XML_TEST_DESCRIPTION);
<span class="line-modified">72 		String currentConfiguration = mbean.retrieveEventProbes();</span>
<span class="line-modified">73 		Assert.assertEquals(XML_TEST_DESCRIPTION, currentConfiguration);</span>










74 	}
75 
76 	public void test() {
77 		//Dummy method for instrumentation
78 	}
79 }
</pre>
</td>
<td>
<hr />
<pre>
50 			+ &quot;&lt;events&gt;&quot;
51 			+ &quot;&lt;event id=\&quot;demo.jfr.test1\&quot;&gt;&quot;
52 			+ &quot;&lt;name&gt;JFR Hello World Event 1 &lt;/name&gt;&quot;
53 			+ &quot;&lt;description&gt;Defined in the xml file and added by the agent.&lt;/description&gt;&quot;
54 			+ &quot;&lt;path&gt;demo/jfrhelloworldevent1&lt;/path&gt;&quot;
55 			+ &quot;&lt;stacktrace&gt;true&lt;/stacktrace&gt;&quot;
56 			+ &quot;&lt;class&gt;org.openjdk.jmc.agent.test.InstrumentMe&lt;/class&gt;&quot;
57 			+ &quot;&lt;method&gt;&quot;
58 			+ &quot;&lt;name&gt;printHelloWorldJFR1&lt;/name&gt;&quot;
59 			+ &quot;&lt;descriptor&gt;()V&lt;/descriptor&gt;&quot;
60 			+ &quot;&lt;/method&gt;&quot;
61 			+ &quot;&lt;location&gt;WRAP&lt;/location&gt;&quot;
62 			+ &quot;&lt;/event&gt;&quot;
63 			+ &quot;&lt;/events&gt;&quot;
64 			+ &quot;&lt;/jfragent&gt;&quot;;
65 	@Test
66 	public void testRetrieveEventProbes() throws Exception {
67 		AgentControllerMXBean mbean = JMX.newMXBeanProxy(ManagementFactory.getPlatformMBeanServer(),
68 				new ObjectName(AGENT_OBJECT_NAME), AgentControllerMXBean.class, false);
69 
<span class="line-modified">70 		Assert.assertNotEquals(mbean.retrieveEventProbes(), XML_TEST_DESCRIPTION);</span>
71 		mbean.defineEventProbes(XML_TEST_DESCRIPTION);
<span class="line-modified">72 		Assert.assertEquals(mbean.retrieveEventProbes(), XML_TEST_DESCRIPTION);</span>
<span class="line-modified">73 	}</span>
<span class="line-added">74 </span>
<span class="line-added">75 	@Test</span>
<span class="line-added">76 	public void testRetrieveInvalidConfiguration() throws Exception {</span>
<span class="line-added">77 		AgentControllerMXBean mbean = JMX.newMXBeanProxy(ManagementFactory.getPlatformMBeanServer(),</span>
<span class="line-added">78 				new ObjectName(AGENT_OBJECT_NAME), AgentControllerMXBean.class, false);</span>
<span class="line-added">79 </span>
<span class="line-added">80 		String initialConfiguration = mbean.retrieveEventProbes();</span>
<span class="line-added">81 		String invalidConfiguration = XML_TEST_DESCRIPTION.concat(&quot;&lt;/jfragent&gt;&quot;);</span>
<span class="line-added">82 		mbean.defineEventProbes(invalidConfiguration);</span>
<span class="line-added">83 		Assert.assertEquals(mbean.retrieveEventProbes(), initialConfiguration);</span>
84 	}
85 
86 	public void test() {
87 		//Dummy method for instrumentation
88 	}
89 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../main/java/org/openjdk/jmc/agent/jmx/AgentControllerMXBean.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>