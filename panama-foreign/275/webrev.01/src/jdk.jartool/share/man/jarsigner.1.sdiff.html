<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.jartool/share/man/jarsigner.1</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="jar.1.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AbstractExecutableMemberWriter.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jartool/share/man/jarsigner.1</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
   1 .\&quot;t
<span class="line-modified">   2 .\&quot; Copyright (c) 1994, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   3 .\&quot; DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 .\&quot;
   5 .\&quot; This code is free software; you can redistribute it and/or modify it
   6 .\&quot; under the terms of the GNU General Public License version 2 only, as
   7 .\&quot; published by the Free Software Foundation.
   8 .\&quot;
   9 .\&quot; This code is distributed in the hope that it will be useful, but WITHOUT
  10 .\&quot; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11 .\&quot; FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
  12 .\&quot; version 2 for more details (a copy is included in the LICENSE file that
  13 .\&quot; accompanied this code).
  14 .\&quot;
  15 .\&quot; You should have received a copy of the GNU General Public License version
  16 .\&quot; 2 along with this work; if not, write to the Free Software Foundation,
  17 .\&quot; Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18 .\&quot;
  19 .\&quot; Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20 .\&quot; or visit www.oracle.com if you need additional information or have any
  21 .\&quot; questions.
  22 .\&quot;
  23 .\&quot; Automatically generated by Pandoc 2.3.1
  24 .\&quot;
<span class="line-modified">  25 .TH &quot;JARSIGNER&quot; &quot;1&quot; &quot;2020&quot; &quot;JDK 14&quot; &quot;JDK Commands&quot;</span>
  26 .hy
  27 .SH NAME
  28 .PP
  29 jarsigner \- sign and verify Java Archive (JAR) files
  30 .SH SYNOPSIS
  31 .PP
  32 \f[CB]jarsigner\f[R] [\f[I]options\f[R]] \f[I]jar\-file\f[R] \f[I]alias\f[R]
  33 .PP
  34 \f[CB]jarsigner\f[R] \f[CB]\-verify\f[R] [\f[I]options\f[R]]
  35 \f[I]jar\-file\f[R] [\f[I]alias\f[R] ...]
  36 .TP
  37 .B \f[I]options\f[R]
  38 The command\-line options.
  39 See \f[B]Options for jarsigner\f[R].
  40 .RS
  41 .RE
  42 .TP
  43 .B \f[CB]\-verify\f[R]
  44 The \f[CB]\-verify\f[R] option can take zero or more keystore alias names
  45 after the JAR file name.
</pre>
<hr />
<pre>
 128 The \f[CB]jarsigner\f[R] command can generate signatures that include a
 129 time stamp that enables a systems or deployer to check whether the JAR
 130 file was signed while the signing certificate was still valid.
 131 .PP
 132 In addition, APIs allow applications to obtain the timestamp
 133 information.
 134 .PP
 135 At this time, the \f[CB]jarsigner\f[R] command can only sign JAR files
 136 created by the \f[CB]jar\f[R] command or zip files.
 137 JAR files are the same as zip files, except they also have a
 138 \f[CB]META\-INF/MANIFEST.MF\f[R] file.
 139 A \f[CB]META\-INF/MANIFEST.MF\f[R] file is created when the
 140 \f[CB]jarsigner\f[R] command signs a zip file.
 141 .PP
 142 The default \f[CB]jarsigner\f[R] command behavior is to sign a JAR or zip
 143 file.
 144 Use the \f[CB]\-verify\f[R] option to verify a signed JAR file.
 145 .PP
 146 The \f[CB]jarsigner\f[R] command also attempts to validate the
 147 signer\[aq]s certificate after signing or verifying.



 148 If there is a validation error or any other problem, the command
 149 generates warning messages.
 150 If you specify the \f[CB]\-strict\f[R] option, then the command treats
 151 severe warnings as errors.
 152 See \f[B]Errors and Warnings\f[R].
 153 .SH KEYSTORE ALIASES
 154 .PP
 155 All keystore entities are accessed with unique aliases.
 156 .PP
 157 When you use the \f[CB]jarsigner\f[R] command to sign a JAR file, you must
 158 specify the alias for the keystore entry that contains the private key
 159 needed to generate the signature.
 160 If no output file is specified, it overwrites the original JAR file with
 161 the signed JAR file.
 162 .PP
 163 Keystores are protected with a password, so the store password must be
 164 specified.
 165 You are prompted for it when you don\[aq]t specify it on the command
 166 line.
 167 Similarly, private keys are protected in a keystore with a password, so
 168 the private key\[aq]s password must be specified, and you are prompted
 169 for the password when you don\[aq]t specify it on the command line and
 170 it isn\[aq]t the same as the store password.
 171 .SH KEYSTORE LOCATION
 172 .PP
 173 The \f[CB]jarsigner\f[R] command has a \f[CB]\-keystore\f[R] option for
 174 specifying the URL of the keystore to be used.
 175 The keystore is by default stored in a file named \f[CB]\&amp;.keystore\f[R]
 176 in the user\[aq]s home directory, as determined by the
 177 \f[CB]user.home\f[R] system property.
 178 .PP
<span class="line-modified"> 179 \f[B]Oracle Solaris, Linux, and OS X:\f[R] \f[CB]user.home\f[R] defaults to</span>
<span class="line-modified"> 180 the user\[aq]s home directory.</span>
 181 .PP
 182 The input stream from the \f[CB]\-keystore\f[R] option is passed to the
 183 \f[CB]KeyStore.load\f[R] method.
 184 If \f[CB]NONE\f[R] is specified as the URL, then a null stream is passed
 185 to the \f[CB]KeyStore.load\f[R] method.
 186 \f[CB]NONE\f[R] should be specified when the \f[CB]KeyStore\f[R] class
 187 isn\[aq]t file based, for example, when it resides on a hardware token
 188 device.
 189 .SH KEYSTORE IMPLEMENTATION
 190 .PP
 191 The \f[CB]KeyStore\f[R] class provided in the \f[CB]java.security\f[R]
 192 package supplies a number of well\-defined interfaces to access and
 193 modify the information in a keystore.
 194 You can have multiple different concrete implementations, where each
 195 implementation is for a particular type of keystore.
 196 .PP
 197 Currently, there are two command\-line tools that use keystore
 198 implementations (\f[CB]keytool\f[R] and \f[CB]jarsigner\f[R]).
 199 .PP
 200 The default keystore implementation is \f[CB]PKCS12\f[R].
</pre>
<hr />
<pre>
 334 T}@T{
 335 SHA256withECDSA
 336 T}
 337 T{
 338 T}@T{
 339 &lt; 512
 340 T}@T{
 341 SHA384withECDSA
 342 T}
 343 T{
 344 T}@T{
 345 = 512
 346 T}@T{
 347 SHA512withECDSA
 348 T}
 349 .TE
 350 .PP
 351 These default signature algorithms can be overridden by using the
 352 \f[CB]\-sigalg\f[R] option.
 353 .PP
<span class="line-modified"> 354 Signed JAR file algorithms are checked against the</span>
<span class="line-modified"> 355 \f[CB]jdk.jar.disabledAlgorithms\f[R] security property during</span>
<span class="line-modified"> 356 verification (\f[CB]\-verify\f[R]).</span>

 357 If the JAR file was signed with any algorithms that are disabled, it
 358 will be treated as an unsigned JAR file.



 359 For detailed verification output, include
 360 \f[CB]\-J\-Djava.security.debug=jar\f[R].
<span class="line-modified"> 361 The default value for the \f[CB]jdk.jar.disabledAlgorithms\f[R] security</span>
<span class="line-modified"> 362 property is defined in the \f[CB]java.security\f[R] file (located in the</span>
<span class="line-modified"> 363 JRE\[aq]s \f[CB]$JAVA_HOME/conf/security\f[R] directory).</span>

 364 .PP
 365 \f[B]Note:\f[R]
 366 .PP
 367 In order to improve out of the box security, default key size and
 368 signature algorithm names are periodically updated to stronger values
 369 with each release of the JDK.
 370 If interoperability with older releases of the JDK is important, please
 371 make sure the defaults are supported by those releases, or alternatively
 372 use the \f[CB]\-sigalg\f[R] option to override the default values at your
 373 own risk.
 374 .SH THE SIGNED JAR FILE
 375 .PP
 376 When the \f[CB]jarsigner\f[R] command is used to sign a JAR file, the
 377 output signed JAR file is exactly the same as the input JAR file, except
 378 that it has two additional files placed in the META\-INF directory:
 379 .IP \[bu] 2
 380 A signature file with an \f[CB]\&amp;.SF\f[R] extension
 381 .IP \[bu] 2
 382 A signature block file with a \f[CB]\&amp;.DSA\f[R], \f[CB]\&amp;.RSA\f[R], or
 383 \f[CB]\&amp;.EC\f[R] extension
</pre>
<hr />
<pre>
 578 A keystore is required when signing.
 579 You must explicitly specify a keystore when the default keystore
 580 doesn\[aq]t exist or if you want to use one other than the default.
 581 .PP
 582 A keystore isn\[aq]t required when verifying, but if one is specified or
 583 the default exists and the \f[CB]\-verbose\f[R] option was also specified,
 584 then additional information is output regarding whether or not any of
 585 the certificates used to verify the JAR file are contained in that
 586 keystore.
 587 .PP
 588 The \f[CB]\-keystore\f[R] argument can be a file name and path
 589 specification rather than a URL, in which case it is treated the same as
 590 a file: URL, for example, the following are equivalent:
 591 .IP \[bu] 2
 592 \f[CB]\-keystore\f[R] \f[I]filePathAndName\f[R]
 593 .IP \[bu] 2
 594 \f[CB]\-keystore\ file:\f[R]\f[I]filePathAndName\f[R]
 595 .PP
 596 If the Sun PKCS #11 provider was configured in the
 597 \f[CB]java.security\f[R] security properties file (located in the
<span class="line-modified"> 598 JRE\[aq]s \f[CB]$JAVA_HOME/conf/security\f[R] directory), then the</span>
 599 \f[CB]keytool\f[R] and \f[CB]jarsigner\f[R] tools can operate on the PKCS
 600 #11 token by specifying these options:
 601 .RS
 602 .PP
 603 \f[CB]\-keystore\ NONE\ \-storetype\ PKCS11\f[R]
 604 .RE
 605 .PP
 606 For example, the following command lists the contents of the configured
 607 PKCS#11 token:
 608 .RS
 609 .PP
 610 \f[CB]keytool\ \-keystore\ NONE\ \-storetype\ PKCS11\ \-list\f[R]
 611 .RE
 612 .RE
 613 .TP
 614 .B \f[CB]\-storepass\f[R] [\f[CB]:env\f[R] | \f[CB]:file\f[R]] \f[I]argument\f[R]
 615 Specifies the password that is required to access the keystore.
 616 This is only needed when signing (not verifying) a JAR file.
 617 In that case, if a \f[CB]\-storepass\f[R] option isn\[aq]t provided at the
 618 command line, then the user is prompted for the password.
</pre>
<hr />
<pre>
 793 .TP
 794 .B \f[CB]\-certs\f[R]
 795 If the \f[CB]\-certs\f[R] option appears on the command line with the
 796 \f[CB]\-verify\f[R] and \f[CB]\-verbose\f[R] options, then the output
 797 includes certificate information for each signer of the JAR file.
 798 This information includes the name of the type of certificate (stored in
 799 the \f[CB]\&amp;.DSA\f[R] file) that certifies the signer\[aq]s public key,
 800 and if the certificate is an X.509 certificate (an instance of the
 801 \f[CB]java.security.cert.X509Certificate\f[R]), then the distinguished
 802 name of the signer.
 803 .RS
 804 .PP
 805 The keystore is also examined.
 806 If no keystore value is specified on the command line, then the default
 807 keystore file (if any) is checked.
 808 If the public key certificate for a signer matches an entry in the
 809 keystore, then the alias name for the keystore entry for that signer is
 810 displayed in parentheses.
 811 .RE
 812 .TP











 813 .B \f[CB]\-tsa\f[R] \f[I]url\f[R]
 814 If \f[CB]\-tsa\ http://example.tsa.url\f[R] appears on the command line
 815 when signing a JAR file then a time stamp is generated for the
 816 signature.
 817 The URL, \f[CB]http://example.tsa.url\f[R], identifies the location of the
 818 Time Stamping Authority (TSA) and overrides any URL found with the
 819 \f[CB]\-tsacert\f[R] option.
 820 The \f[CB]\-tsa\f[R] option doesn\[aq]t require the TSA public key
 821 certificate to be present in the keystore.
 822 .RS
 823 .PP
 824 To generate the time stamp, \f[CB]jarsigner\f[R] communicates with the TSA
 825 with the Time\-Stamp Protocol (TSP) defined in RFC 3161.
 826 When successful, the time stamp token returned by the TSA is stored with
 827 the signature in the signature block file.
 828 .RE
 829 .TP
 830 .B \f[CB]\-tsacert\f[R] \f[I]alias\f[R]
 831 When \f[CB]\-tsacert\f[R] \f[I]alias\f[R] appears on the command line when
 832 signing a JAR file, a time stamp is generated for the signature.
</pre>
<hr />
<pre>
1014 mechanism.
1015 .RS
1016 .PP
1017 For example, to use the signing mechanism provided by a class named
1018 \f[CB]com.sun.sun.jarsigner.AuthSigner\f[R], use the \f[CB]jarsigner\f[R]
1019 option \f[CB]\-altsigner\ com.sun.jarsigner.AuthSigner\f[R].
1020 .RE
1021 .TP
1022 .B \f[CB]\-altsignerpath\f[R] \f[I]classpathlist\f[R]
1023 Specifies the path to the class file and any JAR file it depends on.
1024 The class file name is specified with the \f[CB]\-altsigner\f[R] option.
1025 If the class file is in a JAR file, then this option specifies the path
1026 to that JAR file.
1027 .RS
1028 .PP
1029 An absolute path or a path relative to the current directory can be
1030 specified.
1031 If \f[I]classpathlist\f[R] contains multiple paths or JAR files, then
1032 they should be separated with a:
1033 .IP \[bu] 2
<span class="line-modified">1034 Colon (\f[CB]:\f[R]) on Oracle Solaris, Linux, and macOS</span>
1035 .IP \[bu] 2
1036 Semicolon (\f[CB];\f[R]) on Windows
1037 .PP
1038 This option isn\[aq]t necessary when the class is already in the search
1039 path.
1040 .PP
1041 The following example shows how to specify the path to a JAR file that
1042 contains the class file.
1043 The JAR file name is included.
1044 .RS
1045 .PP
1046 \f[CB]\-altsignerpath\ /home/user/lib/authsigner.jar\f[R]
1047 .RE
1048 .PP
1049 The following example shows how to specify the path to the JAR file that
1050 contains the class file.
1051 The JAR file name is omitted.
1052 .RS
1053 .PP
1054 \f[CB]\-altsignerpath\ /home/user/classes/com/sun/tools/jarsigner/\f[R]
</pre>
<hr />
<pre>
1056 .RE
1057 .SH ERRORS AND WARNINGS
1058 .PP
1059 During the signing or verifying process, the \f[CB]jarsigner\f[R] command
1060 may issue various errors or warnings.
1061 .PP
1062 If there is a failure, the \f[CB]jarsigner\f[R] command exits with code 1.
1063 If there is no failure, but there are one or more severe warnings, the
1064 \f[CB]jarsigner\f[R] command exits with code 0 when the \f[CB]\-strict\f[R]
1065 option is \f[B]not\f[R] specified, or exits with the OR\-value of the
1066 warning codes when the \f[CB]\-strict\f[R] is specified.
1067 If there is only informational warnings or no warning at all, the
1068 command always exits with code 0.
1069 .PP
1070 For example, if a certificate used to sign an entry is expired and has a
1071 KeyUsage extension that doesn\[aq]t allow it to sign a file, the
1072 \f[CB]jarsigner\f[R] command exits with code 12 (=4+8) when the
1073 \f[CB]\-strict\f[R] option is specified.
1074 .PP
1075 \f[B]Note:\f[R] Exit codes are reused because only the values from 0 to
<span class="line-modified">1076 255 are legal on Oracle Solaris, Linux, and OS X.</span>
1077 .PP
1078 The following sections describes the names, codes, and descriptions of
1079 the errors and warnings that the \f[CB]jarsigner\f[R] command can issue.
1080 .SH FAILURE
1081 .PP
1082 Reasons why the \f[CB]jarsigner\f[R] command fails include (but aren\[aq]t
1083 limited to) a command line parsing error, the inability to find a
1084 keypair to sign the JAR file, or the verification of a signed JAR fails.
1085 .TP
1086 .B failure
1087 Code 1.
1088 The signing or verifying fails.
1089 .RS
1090 .RE
1091 .SH SEVERE WARNINGS
1092 .PP
1093 \f[B]Note:\f[R]
1094 .PP
1095 Severe warnings are reported as errors if you specify the
1096 \f[CB]\-strict\f[R] option.
</pre>
<hr />
<pre>
1118 .RE
1119 .TP
1120 .B chainNotValidated
1121 Code 4.
1122 This JAR contains entries whose certificate chain isn\[aq]t validated.
1123 .RS
1124 .RE
1125 .TP
1126 .B tsaChainNotValidated
1127 Code 64.
1128 The timestamp is invalid.
1129 .RS
1130 .RE
1131 .TP
1132 .B signerSelfSigned
1133 Code 4.
1134 This JAR contains entries whose signer certificate is self signed.
1135 .RS
1136 .RE
1137 .TP
<span class="line-modified">1138 .B weakAlg</span>
1139 Code 4.
<span class="line-modified">1140 An algorithm specified on the command line is considered a security</span>
<span class="line-removed">1141 risk.</span>
1142 .RS
1143 .RE
1144 .TP
1145 .B badKeyUsage
1146 Code 8.
1147 This JAR contains entries whose signer certificate\[aq]s KeyUsage
1148 extension doesn\[aq]t allow code signing.
1149 .RS
1150 .RE
1151 .TP
1152 .B badExtendedKeyUsage
1153 Code 8.
1154 This JAR contains entries whose signer certificate\[aq]s
1155 ExtendedKeyUsage extension doesn\[aq]t allow code signing.
1156 .RS
1157 .RE
1158 .TP
1159 .B badNetscapeCertType
1160 Code 8.
1161 This JAR contains entries whose signer certificate\[aq]s
</pre>
<hr />
<pre>
1189 This JAR contains entries whose TSA certificate chain is invalid.
1190 .RS
1191 .RE
1192 .SH INFORMATIONAL WARNINGS
1193 .PP
1194 Informational warnings include those that aren\[aq]t errors but regarded
1195 as bad practice.
1196 They don\[aq]t have a code.
1197 .TP
1198 .B hasExpiringCert
1199 This JAR contains entries whose signer certificate expires within six
1200 months.
1201 .RS
1202 .RE
1203 .TP
1204 .B hasExpiringTsaCert
1205 The timestamp will expire within one year on \f[CB]YYYY\-MM\-DD\f[R].
1206 .RS
1207 .RE
1208 .TP





1209 .B noTimestamp
1210 This JAR contains signatures that doesn\[aq]t include a timestamp.
1211 Without a timestamp, users may not be able to validate this JAR file
1212 after the signer certificate\[aq]s expiration date
1213 (\f[CB]YYYY\-MM\-DD\f[R]) or after any future revocation date.
1214 .RS
1215 .RE
1216 .SH EXAMPLE OF SIGNING A JAR FILE
1217 .PP
1218 Use the following command to sign \f[CB]bundle.jar\f[R] with the private
1219 key of a user whose keystore alias is \f[CB]jane\f[R] in a keystore named
1220 \f[CB]mystore\f[R] in the \f[CB]working\f[R] directory and name the signed
1221 JAR file \f[CB]sbundle.jar\f[R]:
1222 .RS
1223 .PP
1224 \f[CB]jarsigner\ \-keystore\ /working/mystore\ \-storepass\f[R]
1225 \f[I]keystore_password\f[R] \f[CB]\-keypass\f[R]
1226 \f[I]private_key_password\f[R]
1227 \f[CB]\-signedjar\ sbundle.jar\ bundle.jar\ jane\f[R]
1228 .RE
</pre>
</td>
<td>
<hr />
<pre>
   1 .\&quot;t
<span class="line-modified">   2 .\&quot; Copyright (c) 1998, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   3 .\&quot; DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 .\&quot;
   5 .\&quot; This code is free software; you can redistribute it and/or modify it
   6 .\&quot; under the terms of the GNU General Public License version 2 only, as
   7 .\&quot; published by the Free Software Foundation.
   8 .\&quot;
   9 .\&quot; This code is distributed in the hope that it will be useful, but WITHOUT
  10 .\&quot; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11 .\&quot; FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
  12 .\&quot; version 2 for more details (a copy is included in the LICENSE file that
  13 .\&quot; accompanied this code).
  14 .\&quot;
  15 .\&quot; You should have received a copy of the GNU General Public License version
  16 .\&quot; 2 along with this work; if not, write to the Free Software Foundation,
  17 .\&quot; Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18 .\&quot;
  19 .\&quot; Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20 .\&quot; or visit www.oracle.com if you need additional information or have any
  21 .\&quot; questions.
  22 .\&quot;
  23 .\&quot; Automatically generated by Pandoc 2.3.1
  24 .\&quot;
<span class="line-modified">  25 .TH &quot;JARSIGNER&quot; &quot;1&quot; &quot;2020&quot; &quot;JDK 15&quot; &quot;JDK Commands&quot;</span>
  26 .hy
  27 .SH NAME
  28 .PP
  29 jarsigner \- sign and verify Java Archive (JAR) files
  30 .SH SYNOPSIS
  31 .PP
  32 \f[CB]jarsigner\f[R] [\f[I]options\f[R]] \f[I]jar\-file\f[R] \f[I]alias\f[R]
  33 .PP
  34 \f[CB]jarsigner\f[R] \f[CB]\-verify\f[R] [\f[I]options\f[R]]
  35 \f[I]jar\-file\f[R] [\f[I]alias\f[R] ...]
  36 .TP
  37 .B \f[I]options\f[R]
  38 The command\-line options.
  39 See \f[B]Options for jarsigner\f[R].
  40 .RS
  41 .RE
  42 .TP
  43 .B \f[CB]\-verify\f[R]
  44 The \f[CB]\-verify\f[R] option can take zero or more keystore alias names
  45 after the JAR file name.
</pre>
<hr />
<pre>
 128 The \f[CB]jarsigner\f[R] command can generate signatures that include a
 129 time stamp that enables a systems or deployer to check whether the JAR
 130 file was signed while the signing certificate was still valid.
 131 .PP
 132 In addition, APIs allow applications to obtain the timestamp
 133 information.
 134 .PP
 135 At this time, the \f[CB]jarsigner\f[R] command can only sign JAR files
 136 created by the \f[CB]jar\f[R] command or zip files.
 137 JAR files are the same as zip files, except they also have a
 138 \f[CB]META\-INF/MANIFEST.MF\f[R] file.
 139 A \f[CB]META\-INF/MANIFEST.MF\f[R] file is created when the
 140 \f[CB]jarsigner\f[R] command signs a zip file.
 141 .PP
 142 The default \f[CB]jarsigner\f[R] command behavior is to sign a JAR or zip
 143 file.
 144 Use the \f[CB]\-verify\f[R] option to verify a signed JAR file.
 145 .PP
 146 The \f[CB]jarsigner\f[R] command also attempts to validate the
 147 signer\[aq]s certificate after signing or verifying.
<span class="line-added"> 148 During validation, it checks the revocation status of each certificate</span>
<span class="line-added"> 149 in the signer\[aq]s certificate chain when the \f[CB]\-revCheck\f[R]</span>
<span class="line-added"> 150 option is specified.</span>
 151 If there is a validation error or any other problem, the command
 152 generates warning messages.
 153 If you specify the \f[CB]\-strict\f[R] option, then the command treats
 154 severe warnings as errors.
 155 See \f[B]Errors and Warnings\f[R].
 156 .SH KEYSTORE ALIASES
 157 .PP
 158 All keystore entities are accessed with unique aliases.
 159 .PP
 160 When you use the \f[CB]jarsigner\f[R] command to sign a JAR file, you must
 161 specify the alias for the keystore entry that contains the private key
 162 needed to generate the signature.
 163 If no output file is specified, it overwrites the original JAR file with
 164 the signed JAR file.
 165 .PP
 166 Keystores are protected with a password, so the store password must be
 167 specified.
 168 You are prompted for it when you don\[aq]t specify it on the command
 169 line.
 170 Similarly, private keys are protected in a keystore with a password, so
 171 the private key\[aq]s password must be specified, and you are prompted
 172 for the password when you don\[aq]t specify it on the command line and
 173 it isn\[aq]t the same as the store password.
 174 .SH KEYSTORE LOCATION
 175 .PP
 176 The \f[CB]jarsigner\f[R] command has a \f[CB]\-keystore\f[R] option for
 177 specifying the URL of the keystore to be used.
 178 The keystore is by default stored in a file named \f[CB]\&amp;.keystore\f[R]
 179 in the user\[aq]s home directory, as determined by the
 180 \f[CB]user.home\f[R] system property.
 181 .PP
<span class="line-modified"> 182 \f[B]Linux and OS X:\f[R] \f[CB]user.home\f[R] defaults to the user\[aq]s</span>
<span class="line-modified"> 183 home directory.</span>
 184 .PP
 185 The input stream from the \f[CB]\-keystore\f[R] option is passed to the
 186 \f[CB]KeyStore.load\f[R] method.
 187 If \f[CB]NONE\f[R] is specified as the URL, then a null stream is passed
 188 to the \f[CB]KeyStore.load\f[R] method.
 189 \f[CB]NONE\f[R] should be specified when the \f[CB]KeyStore\f[R] class
 190 isn\[aq]t file based, for example, when it resides on a hardware token
 191 device.
 192 .SH KEYSTORE IMPLEMENTATION
 193 .PP
 194 The \f[CB]KeyStore\f[R] class provided in the \f[CB]java.security\f[R]
 195 package supplies a number of well\-defined interfaces to access and
 196 modify the information in a keystore.
 197 You can have multiple different concrete implementations, where each
 198 implementation is for a particular type of keystore.
 199 .PP
 200 Currently, there are two command\-line tools that use keystore
 201 implementations (\f[CB]keytool\f[R] and \f[CB]jarsigner\f[R]).
 202 .PP
 203 The default keystore implementation is \f[CB]PKCS12\f[R].
</pre>
<hr />
<pre>
 337 T}@T{
 338 SHA256withECDSA
 339 T}
 340 T{
 341 T}@T{
 342 &lt; 512
 343 T}@T{
 344 SHA384withECDSA
 345 T}
 346 T{
 347 T}@T{
 348 = 512
 349 T}@T{
 350 SHA512withECDSA
 351 T}
 352 .TE
 353 .PP
 354 These default signature algorithms can be overridden by using the
 355 \f[CB]\-sigalg\f[R] option.
 356 .PP
<span class="line-modified"> 357 The \f[CB]jarsigner\f[R] command uses the</span>
<span class="line-modified"> 358 \f[CB]jdk.jar.disabledAlgorithms\f[R] and</span>
<span class="line-modified"> 359 \f[CB]jdk.security.legacyAlgorithms\f[R] security properties to determine</span>
<span class="line-added"> 360 which algorithms are considered a security risk.</span>
 361 If the JAR file was signed with any algorithms that are disabled, it
 362 will be treated as an unsigned JAR file.
<span class="line-added"> 363 If the JAR file was signed with any legacy algorithms, it will be</span>
<span class="line-added"> 364 treated as signed with an informational warning to inform users that the</span>
<span class="line-added"> 365 legacy algorithm will be disabled in a future update.</span>
 366 For detailed verification output, include
 367 \f[CB]\-J\-Djava.security.debug=jar\f[R].
<span class="line-modified"> 368 The \f[CB]jdk.jar.disabledAlgorithms\f[R] and</span>
<span class="line-modified"> 369 \f[CB]jdk.security.legacyAlgorithms\f[R] security properties are defined</span>
<span class="line-modified"> 370 in the \f[CB]java.security\f[R] file (located in the JDK\[aq]s</span>
<span class="line-added"> 371 \f[CB]$JAVA_HOME/conf/security\f[R] directory).</span>
 372 .PP
 373 \f[B]Note:\f[R]
 374 .PP
 375 In order to improve out of the box security, default key size and
 376 signature algorithm names are periodically updated to stronger values
 377 with each release of the JDK.
 378 If interoperability with older releases of the JDK is important, please
 379 make sure the defaults are supported by those releases, or alternatively
 380 use the \f[CB]\-sigalg\f[R] option to override the default values at your
 381 own risk.
 382 .SH THE SIGNED JAR FILE
 383 .PP
 384 When the \f[CB]jarsigner\f[R] command is used to sign a JAR file, the
 385 output signed JAR file is exactly the same as the input JAR file, except
 386 that it has two additional files placed in the META\-INF directory:
 387 .IP \[bu] 2
 388 A signature file with an \f[CB]\&amp;.SF\f[R] extension
 389 .IP \[bu] 2
 390 A signature block file with a \f[CB]\&amp;.DSA\f[R], \f[CB]\&amp;.RSA\f[R], or
 391 \f[CB]\&amp;.EC\f[R] extension
</pre>
<hr />
<pre>
 586 A keystore is required when signing.
 587 You must explicitly specify a keystore when the default keystore
 588 doesn\[aq]t exist or if you want to use one other than the default.
 589 .PP
 590 A keystore isn\[aq]t required when verifying, but if one is specified or
 591 the default exists and the \f[CB]\-verbose\f[R] option was also specified,
 592 then additional information is output regarding whether or not any of
 593 the certificates used to verify the JAR file are contained in that
 594 keystore.
 595 .PP
 596 The \f[CB]\-keystore\f[R] argument can be a file name and path
 597 specification rather than a URL, in which case it is treated the same as
 598 a file: URL, for example, the following are equivalent:
 599 .IP \[bu] 2
 600 \f[CB]\-keystore\f[R] \f[I]filePathAndName\f[R]
 601 .IP \[bu] 2
 602 \f[CB]\-keystore\ file:\f[R]\f[I]filePathAndName\f[R]
 603 .PP
 604 If the Sun PKCS #11 provider was configured in the
 605 \f[CB]java.security\f[R] security properties file (located in the
<span class="line-modified"> 606 JDK\[aq]s \f[CB]$JAVA_HOME/conf/security\f[R] directory), then the</span>
 607 \f[CB]keytool\f[R] and \f[CB]jarsigner\f[R] tools can operate on the PKCS
 608 #11 token by specifying these options:
 609 .RS
 610 .PP
 611 \f[CB]\-keystore\ NONE\ \-storetype\ PKCS11\f[R]
 612 .RE
 613 .PP
 614 For example, the following command lists the contents of the configured
 615 PKCS#11 token:
 616 .RS
 617 .PP
 618 \f[CB]keytool\ \-keystore\ NONE\ \-storetype\ PKCS11\ \-list\f[R]
 619 .RE
 620 .RE
 621 .TP
 622 .B \f[CB]\-storepass\f[R] [\f[CB]:env\f[R] | \f[CB]:file\f[R]] \f[I]argument\f[R]
 623 Specifies the password that is required to access the keystore.
 624 This is only needed when signing (not verifying) a JAR file.
 625 In that case, if a \f[CB]\-storepass\f[R] option isn\[aq]t provided at the
 626 command line, then the user is prompted for the password.
</pre>
<hr />
<pre>
 801 .TP
 802 .B \f[CB]\-certs\f[R]
 803 If the \f[CB]\-certs\f[R] option appears on the command line with the
 804 \f[CB]\-verify\f[R] and \f[CB]\-verbose\f[R] options, then the output
 805 includes certificate information for each signer of the JAR file.
 806 This information includes the name of the type of certificate (stored in
 807 the \f[CB]\&amp;.DSA\f[R] file) that certifies the signer\[aq]s public key,
 808 and if the certificate is an X.509 certificate (an instance of the
 809 \f[CB]java.security.cert.X509Certificate\f[R]), then the distinguished
 810 name of the signer.
 811 .RS
 812 .PP
 813 The keystore is also examined.
 814 If no keystore value is specified on the command line, then the default
 815 keystore file (if any) is checked.
 816 If the public key certificate for a signer matches an entry in the
 817 keystore, then the alias name for the keystore entry for that signer is
 818 displayed in parentheses.
 819 .RE
 820 .TP
<span class="line-added"> 821 .B \f[CB]\-revCheck\f[R]</span>
<span class="line-added"> 822 This option enables revocation checking of certificates when signing or</span>
<span class="line-added"> 823 verifying a JAR file.</span>
<span class="line-added"> 824 The \f[CB]jarsigner\f[R] command attempts to make network connections to</span>
<span class="line-added"> 825 fetch OCSP responses and CRLs if the \f[CB]\-revCheck\f[R] option is</span>
<span class="line-added"> 826 specified on the command line.</span>
<span class="line-added"> 827 Note that revocation checks are not enabled unless this option is</span>
<span class="line-added"> 828 specified.</span>
<span class="line-added"> 829 .RS</span>
<span class="line-added"> 830 .RE</span>
<span class="line-added"> 831 .TP</span>
 832 .B \f[CB]\-tsa\f[R] \f[I]url\f[R]
 833 If \f[CB]\-tsa\ http://example.tsa.url\f[R] appears on the command line
 834 when signing a JAR file then a time stamp is generated for the
 835 signature.
 836 The URL, \f[CB]http://example.tsa.url\f[R], identifies the location of the
 837 Time Stamping Authority (TSA) and overrides any URL found with the
 838 \f[CB]\-tsacert\f[R] option.
 839 The \f[CB]\-tsa\f[R] option doesn\[aq]t require the TSA public key
 840 certificate to be present in the keystore.
 841 .RS
 842 .PP
 843 To generate the time stamp, \f[CB]jarsigner\f[R] communicates with the TSA
 844 with the Time\-Stamp Protocol (TSP) defined in RFC 3161.
 845 When successful, the time stamp token returned by the TSA is stored with
 846 the signature in the signature block file.
 847 .RE
 848 .TP
 849 .B \f[CB]\-tsacert\f[R] \f[I]alias\f[R]
 850 When \f[CB]\-tsacert\f[R] \f[I]alias\f[R] appears on the command line when
 851 signing a JAR file, a time stamp is generated for the signature.
</pre>
<hr />
<pre>
1033 mechanism.
1034 .RS
1035 .PP
1036 For example, to use the signing mechanism provided by a class named
1037 \f[CB]com.sun.sun.jarsigner.AuthSigner\f[R], use the \f[CB]jarsigner\f[R]
1038 option \f[CB]\-altsigner\ com.sun.jarsigner.AuthSigner\f[R].
1039 .RE
1040 .TP
1041 .B \f[CB]\-altsignerpath\f[R] \f[I]classpathlist\f[R]
1042 Specifies the path to the class file and any JAR file it depends on.
1043 The class file name is specified with the \f[CB]\-altsigner\f[R] option.
1044 If the class file is in a JAR file, then this option specifies the path
1045 to that JAR file.
1046 .RS
1047 .PP
1048 An absolute path or a path relative to the current directory can be
1049 specified.
1050 If \f[I]classpathlist\f[R] contains multiple paths or JAR files, then
1051 they should be separated with a:
1052 .IP \[bu] 2
<span class="line-modified">1053 Colon (\f[CB]:\f[R]) on Linux and macOS</span>
1054 .IP \[bu] 2
1055 Semicolon (\f[CB];\f[R]) on Windows
1056 .PP
1057 This option isn\[aq]t necessary when the class is already in the search
1058 path.
1059 .PP
1060 The following example shows how to specify the path to a JAR file that
1061 contains the class file.
1062 The JAR file name is included.
1063 .RS
1064 .PP
1065 \f[CB]\-altsignerpath\ /home/user/lib/authsigner.jar\f[R]
1066 .RE
1067 .PP
1068 The following example shows how to specify the path to the JAR file that
1069 contains the class file.
1070 The JAR file name is omitted.
1071 .RS
1072 .PP
1073 \f[CB]\-altsignerpath\ /home/user/classes/com/sun/tools/jarsigner/\f[R]
</pre>
<hr />
<pre>
1075 .RE
1076 .SH ERRORS AND WARNINGS
1077 .PP
1078 During the signing or verifying process, the \f[CB]jarsigner\f[R] command
1079 may issue various errors or warnings.
1080 .PP
1081 If there is a failure, the \f[CB]jarsigner\f[R] command exits with code 1.
1082 If there is no failure, but there are one or more severe warnings, the
1083 \f[CB]jarsigner\f[R] command exits with code 0 when the \f[CB]\-strict\f[R]
1084 option is \f[B]not\f[R] specified, or exits with the OR\-value of the
1085 warning codes when the \f[CB]\-strict\f[R] is specified.
1086 If there is only informational warnings or no warning at all, the
1087 command always exits with code 0.
1088 .PP
1089 For example, if a certificate used to sign an entry is expired and has a
1090 KeyUsage extension that doesn\[aq]t allow it to sign a file, the
1091 \f[CB]jarsigner\f[R] command exits with code 12 (=4+8) when the
1092 \f[CB]\-strict\f[R] option is specified.
1093 .PP
1094 \f[B]Note:\f[R] Exit codes are reused because only the values from 0 to
<span class="line-modified">1095 255 are legal on Linux and OS X.</span>
1096 .PP
1097 The following sections describes the names, codes, and descriptions of
1098 the errors and warnings that the \f[CB]jarsigner\f[R] command can issue.
1099 .SH FAILURE
1100 .PP
1101 Reasons why the \f[CB]jarsigner\f[R] command fails include (but aren\[aq]t
1102 limited to) a command line parsing error, the inability to find a
1103 keypair to sign the JAR file, or the verification of a signed JAR fails.
1104 .TP
1105 .B failure
1106 Code 1.
1107 The signing or verifying fails.
1108 .RS
1109 .RE
1110 .SH SEVERE WARNINGS
1111 .PP
1112 \f[B]Note:\f[R]
1113 .PP
1114 Severe warnings are reported as errors if you specify the
1115 \f[CB]\-strict\f[R] option.
</pre>
<hr />
<pre>
1137 .RE
1138 .TP
1139 .B chainNotValidated
1140 Code 4.
1141 This JAR contains entries whose certificate chain isn\[aq]t validated.
1142 .RS
1143 .RE
1144 .TP
1145 .B tsaChainNotValidated
1146 Code 64.
1147 The timestamp is invalid.
1148 .RS
1149 .RE
1150 .TP
1151 .B signerSelfSigned
1152 Code 4.
1153 This JAR contains entries whose signer certificate is self signed.
1154 .RS
1155 .RE
1156 .TP
<span class="line-modified">1157 .B disabledAlg</span>
1158 Code 4.
<span class="line-modified">1159 An algorithm used is considered a security risk and is disabled.</span>

1160 .RS
1161 .RE
1162 .TP
1163 .B badKeyUsage
1164 Code 8.
1165 This JAR contains entries whose signer certificate\[aq]s KeyUsage
1166 extension doesn\[aq]t allow code signing.
1167 .RS
1168 .RE
1169 .TP
1170 .B badExtendedKeyUsage
1171 Code 8.
1172 This JAR contains entries whose signer certificate\[aq]s
1173 ExtendedKeyUsage extension doesn\[aq]t allow code signing.
1174 .RS
1175 .RE
1176 .TP
1177 .B badNetscapeCertType
1178 Code 8.
1179 This JAR contains entries whose signer certificate\[aq]s
</pre>
<hr />
<pre>
1207 This JAR contains entries whose TSA certificate chain is invalid.
1208 .RS
1209 .RE
1210 .SH INFORMATIONAL WARNINGS
1211 .PP
1212 Informational warnings include those that aren\[aq]t errors but regarded
1213 as bad practice.
1214 They don\[aq]t have a code.
1215 .TP
1216 .B hasExpiringCert
1217 This JAR contains entries whose signer certificate expires within six
1218 months.
1219 .RS
1220 .RE
1221 .TP
1222 .B hasExpiringTsaCert
1223 The timestamp will expire within one year on \f[CB]YYYY\-MM\-DD\f[R].
1224 .RS
1225 .RE
1226 .TP
<span class="line-added">1227 .B legacyAlg</span>
<span class="line-added">1228 An algorithm used is considered a security risk but not disabled.</span>
<span class="line-added">1229 .RS</span>
<span class="line-added">1230 .RE</span>
<span class="line-added">1231 .TP</span>
1232 .B noTimestamp
1233 This JAR contains signatures that doesn\[aq]t include a timestamp.
1234 Without a timestamp, users may not be able to validate this JAR file
1235 after the signer certificate\[aq]s expiration date
1236 (\f[CB]YYYY\-MM\-DD\f[R]) or after any future revocation date.
1237 .RS
1238 .RE
1239 .SH EXAMPLE OF SIGNING A JAR FILE
1240 .PP
1241 Use the following command to sign \f[CB]bundle.jar\f[R] with the private
1242 key of a user whose keystore alias is \f[CB]jane\f[R] in a keystore named
1243 \f[CB]mystore\f[R] in the \f[CB]working\f[R] directory and name the signed
1244 JAR file \f[CB]sbundle.jar\f[R]:
1245 .RS
1246 .PP
1247 \f[CB]jarsigner\ \-keystore\ /working/mystore\ \-storepass\f[R]
1248 \f[I]keystore_password\f[R] \f[CB]\-keypass\f[R]
1249 \f[I]private_key_password\f[R]
1250 \f[CB]\-signedjar\ sbundle.jar\ bundle.jar\ jane\f[R]
1251 .RE
</pre>
</td>
</tr>
</table>
<center><a href="jar.1.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="../../../jdk.javadoc/share/classes/jdk/javadoc/internal/doclets/formats/html/AbstractExecutableMemberWriter.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>