<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/java.desktop/unix/classes/sun/awt/X11FontManager.java</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../share/native/libharfbuzz/hb.hh.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../font/FcFontConfiguration.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/java.desktop/unix/classes/sun/awt/X11FontManager.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 222,19 ***</span>
          if (fontID != null) {
              fileName = fontNameMap.get(fontID);
              if (fontPath == null &amp;&amp;
                  (fileName == null || !fileName.startsWith(&quot;/&quot;))) {
                  if (FontUtilities.debugFonts()) {
<span class="line-modified">!                     FontUtilities.getLogger()</span>
<span class="line-modified">!                           .warning(&quot;** Registering all font paths because &quot; +</span>
<span class="line-removed">-                                    &quot;can&#39;t find file for &quot; + platName);</span>
                  }
                  fontPath = getPlatformFontPath(noType1Font);
                  registerFontDirs(fontPath);
                  if (FontUtilities.debugFonts()) {
<span class="line-modified">!                     FontUtilities.getLogger()</span>
<span class="line-removed">-                             .warning(&quot;** Finished registering all font paths&quot;);</span>
                  }
                  fileName = fontNameMap.get(fontID);
              }
              if (fileName == null &amp;&amp; !isHeadless()) {
                  /* Query X11 directly to see if this font is available
<span class="line-new-header">--- 222,17 ---</span>
          if (fontID != null) {
              fileName = fontNameMap.get(fontID);
              if (fontPath == null &amp;&amp;
                  (fileName == null || !fileName.startsWith(&quot;/&quot;))) {
                  if (FontUtilities.debugFonts()) {
<span class="line-modified">!                     FontUtilities.logWarning(&quot;** Registering all font paths because &quot; +</span>
<span class="line-modified">!                                              &quot;can&#39;t find file for &quot; + platName);</span>
                  }
                  fontPath = getPlatformFontPath(noType1Font);
                  registerFontDirs(fontPath);
                  if (FontUtilities.debugFonts()) {
<span class="line-modified">!                     FontUtilities.logWarning(&quot;** Finished registering all font paths&quot;);</span>
                  }
                  fileName = fontNameMap.get(fontID);
              }
              if (fileName == null &amp;&amp; !isHeadless()) {
                  /* Query X11 directly to see if this font is available
</pre>
<hr />
<pre>
<span class="line-old-header">*** 287,11 ***</span>
           * Arial.ttf -monotype-arial-regular-r-normal--0-0-0-0-p-0-iso8859-1
           * Arial-Bold.ttf -monotype-arial-bold-r-normal--0-0-0-0-p-0-iso8859-1
           * ...
           */
          if (FontUtilities.debugFonts()) {
<span class="line-modified">!             FontUtilities.getLogger().info(&quot;ParseFontDir &quot; + path);</span>
          }
          File fontsDotDir = new File(path + File.separator + &quot;fonts.dir&quot;);
          FileReader fr = null;
          try {
              if (fontsDotDir.canRead()) {
<span class="line-new-header">--- 285,11 ---</span>
           * Arial.ttf -monotype-arial-regular-r-normal--0-0-0-0-p-0-iso8859-1
           * Arial-Bold.ttf -monotype-arial-bold-r-normal--0-0-0-0-p-0-iso8859-1
           * ...
           */
          if (FontUtilities.debugFonts()) {
<span class="line-modified">!             FontUtilities.logInfo(&quot;ParseFontDir &quot; + path);</span>
          }
          File fontsDotDir = new File(path + File.separator + &quot;fonts.dir&quot;);
          FileReader fr = null;
          try {
              if (fontsDotDir.canRead()) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 366,14 ***</span>
                              String fontPart = st.sval.substring(breakPos+1);
                              String fontID = specificFontIDForName(fontPart);
                              String sVal = fontNameMap.get(fontID);
  
                              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                                 PlatformLogger logger = FontUtilities.getLogger();</span>
<span class="line-removed">-                                 logger.info(&quot;file=&quot; + fileName +</span>
                                              &quot; xlfd=&quot; + fontPart);
<span class="line-modified">!                                 logger.info(&quot;fontID=&quot; + fontID +</span>
                                              &quot; sVal=&quot; + sVal);
                              }
                              String fullPath = null;
                              try {
                                  File file = new File(path,fileName);
<span class="line-new-header">--- 364,13 ---</span>
                              String fontPart = st.sval.substring(breakPos+1);
                              String fontID = specificFontIDForName(fontPart);
                              String sVal = fontNameMap.get(fontID);
  
                              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                                 FontUtilities.logInfo(&quot;file=&quot; + fileName +</span>
                                              &quot; xlfd=&quot; + fontPart);
<span class="line-modified">!                                 FontUtilities.logInfo(&quot;fontID=&quot; + fontID +</span>
                                              &quot; sVal=&quot; + sVal);
                              }
                              String fullPath = null;
                              try {
                                  File file = new File(path,fileName);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 392,20 ***</span>
                              } catch (IOException e) {
                                  fullPath = path + File.separator + fileName;
                              }
                              Vector&lt;String&gt; xVal = xlfdMap.get(fullPath);
                              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                                 FontUtilities.getLogger()</span>
<span class="line-modified">!                                       .info(&quot;fullPath=&quot; + fullPath +</span>
<span class="line-removed">-                                             &quot; xVal=&quot; + xVal);</span>
                              }
                              if ((xVal == null || !xVal.contains(fontPart)) &amp;&amp;
                                  (sVal == null) || !sVal.startsWith(&quot;/&quot;)) {
                                  if (FontUtilities.debugFonts()) {
<span class="line-modified">!                                     FontUtilities.getLogger()</span>
<span class="line-modified">!                                           .info(&quot;Map fontID:&quot;+fontID +</span>
<span class="line-removed">-                                                 &quot;to file:&quot; + fullPath);</span>
                                  }
                                  fontNameMap.put(fontID, fullPath);
                                  if (xVal == null) {
                                      xVal = new Vector&lt;&gt;();
                                      xlfdMap.put (fullPath, xVal);
<span class="line-new-header">--- 389,18 ---</span>
                              } catch (IOException e) {
                                  fullPath = path + File.separator + fileName;
                              }
                              Vector&lt;String&gt; xVal = xlfdMap.get(fullPath);
                              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                                 FontUtilities.logInfo(&quot;fullPath=&quot; + fullPath +</span>
<span class="line-modified">!                                                       &quot; xVal=&quot; + xVal);</span>
                              }
                              if ((xVal == null || !xVal.contains(fontPart)) &amp;&amp;
                                  (sVal == null) || !sVal.startsWith(&quot;/&quot;)) {
                                  if (FontUtilities.debugFonts()) {
<span class="line-modified">!                                     FontUtilities.logInfo(&quot;Map fontID:&quot;+fontID +</span>
<span class="line-modified">!                                                           &quot;to file:&quot; + fullPath);</span>
                                  }
                                  fontNameMap.put(fontID, fullPath);
                                  if (xVal == null) {
                                      xVal = new Vector&lt;&gt;();
                                      xlfdMap.put (fullPath, xVal);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 479,12 ***</span>
              }
          }
  
          if (hyphenCnt != 14) {
              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                 FontUtilities.getLogger()</span>
<span class="line-removed">-                     .severe(&quot;Font Configuration Font ID is malformed:&quot; + name);</span>
              }
              return name; // what else can we do?
          }
  
          StringBuffer sb =
<span class="line-new-header">--- 474,11 ---</span>
              }
          }
  
          if (hyphenCnt != 14) {
              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                 FontUtilities.logSevere(&quot;Font Configuration Font ID is malformed:&quot; + name);</span>
              }
              return name; // what else can we do?
          }
  
          StringBuffer sb =
</pre>
<hr />
<pre>
<span class="line-old-header">*** 509,12 ***</span>
              }
          }
  
          if (hyphenCnt != 14) {
              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                 FontUtilities.getLogger()</span>
<span class="line-removed">-                     .severe(&quot;Font Configuration Font ID is malformed:&quot; + name);</span>
              }
              return name; // what else can we do?
          }
  
          String slant = name.substring(hPos[SLANT_FIELD-1]+1,
<span class="line-new-header">--- 503,11 ---</span>
              }
          }
  
          if (hyphenCnt != 14) {
              if (FontUtilities.debugFonts()) {
<span class="line-modified">!                 FontUtilities.logSevere(&quot;Font Configuration Font ID is malformed:&quot; + name);</span>
              }
              return name; // what else can we do?
          }
  
          String slant = name.substring(hPos[SLANT_FIELD-1]+1,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 673,11 ***</span>
          if (fontConfigDirs == null) {
              fontConfigDirs = getFontConfiguration().getAWTFontPathSet();
              if (FontUtilities.debugFonts() &amp;&amp; fontConfigDirs != null) {
                  String[] names = fontConfigDirs.toArray(new String[0]);
                  for (int i=0;i&lt;names.length;i++) {
<span class="line-modified">!                     FontUtilities.getLogger().info(&quot;awtfontpath : &quot; + names[i]);</span>
                  }
              }
          }
      }
  
<span class="line-new-header">--- 666,11 ---</span>
          if (fontConfigDirs == null) {
              fontConfigDirs = getFontConfiguration().getAWTFontPathSet();
              if (FontUtilities.debugFonts() &amp;&amp; fontConfigDirs != null) {
                  String[] names = fontConfigDirs.toArray(new String[0]);
                  for (int i=0;i&lt;names.length;i++) {
<span class="line-modified">!                     FontUtilities.logInfo(&quot;awtfontpath : &quot; + names[i]);</span>
                  }
              }
          }
      }
  
</pre>
<center><a href="../../../../share/native/libharfbuzz/hb.hh.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../index.html" target="_top">index</a> <a href="../font/FcFontConfiguration.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>