<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff src/hotspot/cpu/x86/stubGenerator_x86_32.cpp</title>
    <link rel="stylesheet" href="../../../../style.css" />
  </head>
<body>
<center><a href="gc/shenandoah/shenandoahBarrierSetAssembler_x86.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="stubGenerator_x86_64.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>src/hotspot/cpu/x86/stubGenerator_x86_32.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,7 ***</span>
  /*
<span class="line-modified">!  * Copyright (c) 1999, 2019, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
<span class="line-new-header">--- 1,7 ---</span>
  /*
<span class="line-modified">!  * Copyright (c) 1999, 2020, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 427,42 ***</span>
      __ jmp(handler_addr);
  
      return start;
    }
  
<span class="line-removed">- </span>
<span class="line-removed">-   //----------------------------------------------------------------------------------------------------</span>
<span class="line-removed">-   // Implementation of int32_t atomic_xchg(int32_t exchange_value, volatile int32_t* dest)</span>
<span class="line-removed">-   // used by Atomic::xchg(volatile int32_t* dest, int32_t exchange_value)</span>
<span class="line-removed">-   //</span>
<span class="line-removed">-   // xchg exists as far back as 8086, lock needed for MP only</span>
<span class="line-removed">-   // Stack layout immediately after call:</span>
<span class="line-removed">-   //</span>
<span class="line-removed">-   // 0 [ret addr ] &lt;--- rsp</span>
<span class="line-removed">-   // 1 [  ex     ]</span>
<span class="line-removed">-   // 2 [  dest   ]</span>
<span class="line-removed">-   //</span>
<span class="line-removed">-   // Result:   *dest &lt;- ex, return (old *dest)</span>
<span class="line-removed">-   //</span>
<span class="line-removed">-   // Note: win32 does not currently use this code</span>
<span class="line-removed">- </span>
<span class="line-removed">-   address generate_atomic_xchg() {</span>
<span class="line-removed">-     StubCodeMark mark(this, &quot;StubRoutines&quot;, &quot;atomic_xchg&quot;);</span>
<span class="line-removed">-     address start = __ pc();</span>
<span class="line-removed">- </span>
<span class="line-removed">-     __ push(rdx);</span>
<span class="line-removed">-     Address exchange(rsp, 2 * wordSize);</span>
<span class="line-removed">-     Address dest_addr(rsp, 3 * wordSize);</span>
<span class="line-removed">-     __ movl(rax, exchange);</span>
<span class="line-removed">-     __ movptr(rdx, dest_addr);</span>
<span class="line-removed">-     __ xchgl(rax, Address(rdx, 0));</span>
<span class="line-removed">-     __ pop(rdx);</span>
<span class="line-removed">-     __ ret(0);</span>
<span class="line-removed">- </span>
<span class="line-removed">-     return start;</span>
<span class="line-removed">-   }</span>
<span class="line-removed">- </span>
    //----------------------------------------------------------------------------------------------------
    // Support for void verify_mxcsr()
    //
    // This routine is used with -Xcheck:jni to verify that native
    // JNI code does not return to Java code without restoring the
<span class="line-new-header">--- 427,10 ---</span>
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3795,13 ***</span>
      StubRoutines::_call_stub_entry              =
        generate_call_stub(StubRoutines::_call_stub_return_address);
      // is referenced by megamorphic call
      StubRoutines::_catch_exception_entry        = generate_catch_exception();
  
<span class="line-removed">-     // These are currently used by Solaris/Intel</span>
<span class="line-removed">-     StubRoutines::_atomic_xchg_entry            = generate_atomic_xchg();</span>
<span class="line-removed">- </span>
      // platform dependent
      create_control_words();
  
      StubRoutines::x86::_verify_mxcsr_entry                 = generate_verify_mxcsr();
      StubRoutines::x86::_verify_fpu_cntrl_wrd_entry         = generate_verify_fpu_cntrl_wrd();
<span class="line-new-header">--- 3763,10 ---</span>
</pre>
<center><a href="gc/shenandoah/shenandoahBarrierSetAssembler_x86.cpp.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../index.html" target="_top">index</a> <a href="stubGenerator_x86_64.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>