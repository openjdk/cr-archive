diff a/bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java b/bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java
--- a/bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java
+++ b/bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java
@@ -27,10 +27,11 @@
 import org.openjdk.skara.issuetracker.Issue;
 import org.openjdk.skara.network.URIBuilder;
 import org.openjdk.skara.mailinglist.MailingListServerFactory;
 import org.openjdk.skara.test.*;
 import org.openjdk.skara.vcs.Repository;
+import org.openjdk.skara.json.JSON;
 
 import org.junit.jupiter.api.*;
 
 import java.io.IOException;
 import java.nio.charset.StandardCharsets;
@@ -125,11 +126,11 @@
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .ignoredComments(Set.of())
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .readyLabels(Set.of("rfr"))
                                             .readyComments(Map.of(ignored.forge().currentUser().userName(), Pattern.compile("ready")))
@@ -292,11 +293,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -366,11 +367,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -440,11 +441,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -519,11 +520,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .readyLabels(Set.of("rfr"))
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
@@ -596,11 +597,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .readyLabels(Set.of("rfr"))
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
@@ -679,11 +680,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -733,11 +734,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -827,11 +828,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -922,11 +923,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1051,11 +1052,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1114,11 +1115,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1178,11 +1179,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1243,11 +1244,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1306,11 +1307,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1363,11 +1364,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1439,11 +1440,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1505,11 +1506,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1635,11 +1636,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1732,11 +1733,11 @@
                                             .archiveRef("archive")
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1822,11 +1823,11 @@
                                             .archiveRef("archive")
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1908,11 +1909,11 @@
                                             .archiveRef("archive")
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -1980,11 +1981,11 @@
                                             .archiveRef("archive")
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -2051,11 +2052,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -2131,11 +2132,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -2222,11 +2223,11 @@
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
                                             .ignoredComments(Set.of(Pattern.compile("ignore this comment", Pattern.MULTILINE | Pattern.DOTALL)))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -2287,11 +2288,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -2348,11 +2349,11 @@
                                                    .archive(archive)
                                                    .censusRepo(censusBuilder.build())
                                                    .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                                    .listArchive(listServer.getArchive())
                                                    .smtpServer(listServer.getSMTP())
-                                                   .webrevStorageRepository(archive)
+                                                   .webrevStorageHTMLRepository(archive)
                                                    .webrevStorageRef("webrev")
                                                    .webrevStorageBase(Path.of("test"))
                                                    .webrevStorageBaseUri(webrevServer.uri())
                                                    .issueTracker(URIBuilder.base("http://issues.test/browse/").build());
 
@@ -2413,11 +2414,11 @@
                                                    .archive(archive)
                                                    .censusRepo(censusBuilder.build())
                                                    .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                                    .listArchive(listServer.getArchive())
                                                    .smtpServer(listServer.getSMTP())
-                                                   .webrevStorageRepository(archive)
+                                                   .webrevStorageHTMLRepository(archive)
                                                    .webrevStorageRef("webrev")
                                                    .webrevStorageBase(Path.of("test"))
                                                    .webrevStorageBaseUri(webrevServer.uri())
                                                    .issueTracker(URIBuilder.base("http://issues.test/browse/").build());
 
@@ -2480,11 +2481,11 @@
                                                    .archive(archive)
                                                    .censusRepo(censusBuilder.build())
                                                    .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                                    .listArchive(listServer.getArchive())
                                                    .smtpServer(listServer.getSMTP())
-                                                   .webrevStorageRepository(archive)
+                                                   .webrevStorageHTMLRepository(archive)
                                                    .webrevStorageRef("webrev")
                                                    .webrevStorageBase(Path.of("test"))
                                                    .webrevStorageBaseUri(webrevServer.uri())
                                                    .issueTracker(URIBuilder.base("http://issues.test/browse/").build());
 
@@ -2569,11 +2570,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .branchInSubject(Pattern.compile(".*"))
@@ -2626,11 +2627,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .repoInSubject(true)
@@ -2683,11 +2684,11 @@
                                             .archive(archive)
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .repoInSubject(true)
@@ -2744,11 +2745,11 @@
                                                    .archive(archive)
                                                    .censusRepo(censusBuilder.build())
                                                    .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
                                                    .listArchive(listServer.getArchive())
                                                    .smtpServer(listServer.getSMTP())
-                                                   .webrevStorageRepository(archive)
+                                                   .webrevStorageHTMLRepository(archive)
                                                    .webrevStorageRef("webrev")
                                                    .webrevStorageBase(Path.of("test"))
                                                    .webrevStorageBaseUri(webrevServer.uri())
                                                    .issueTracker(URIBuilder.base("http://issues.test/browse/").build());
 
@@ -2836,11 +2837,11 @@
                                             .censusRepo(censusBuilder.build())
                                             .lists(List.of(new MailingListConfiguration(listAddress1, Set.of("list1")),
                                                            new MailingListConfiguration(listAddress2, Set.of("list2"))))
                                             .listArchive(listServer.getArchive())
                                             .smtpServer(listServer.getSMTP())
-                                            .webrevStorageRepository(archive)
+                                            .webrevStorageHTMLRepository(archive)
                                             .webrevStorageRef("webrev")
                                             .webrevStorageBase(Path.of("test"))
                                             .webrevStorageBaseUri(webrevServer.uri())
                                             .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
                                             .build();
@@ -2890,6 +2891,207 @@
             assertEquals(noreplyAddress(archive), reply.author().address());
             assertEquals(listAddress1, reply.sender());
             assertEquals(List.of(listAddress1, listAddress2), reply.recipients());
         }
     }
+
+    @Test
+    void jsonArchive(TestInfo testInfo) throws IOException {
+        try (var credentials = new HostCredentials(testInfo);
+             var tempFolder = new TemporaryDirectory();
+             var archiveFolder = new TemporaryDirectory();
+             var webrevFolder = new TemporaryDirectory(false);
+             var listServer = new TestMailmanServer();
+             var webrevServer = new TestWebrevServer()) {
+            var author = credentials.getHostedRepository();
+            var archive = credentials.getHostedRepository();
+            var ignored = credentials.getHostedRepository();
+            var listAddress = EmailAddress.parse(listServer.createList("test"));
+            var censusBuilder = credentials.getCensusBuilder()
+                                           .addAuthor(author.forge().currentUser().id());
+            var from = EmailAddress.from("test", "test@test.mail");
+            var mlBot = MailingListBridgeBot.newBuilder()
+                                            .from(from)
+                                            .repo(author)
+                                            .archive(archive)
+                                            .censusRepo(censusBuilder.build())
+                                            .lists(List.of(new MailingListConfiguration(listAddress, Set.of())))
+                                            .ignoredUsers(Set.of(ignored.forge().currentUser().userName()))
+                                            .ignoredComments(Set.of())
+                                            .listArchive(listServer.getArchive())
+                                            .smtpServer(listServer.getSMTP())
+                                            .webrevStorageJSONRepository(archive)
+                                            .webrevStorageRef("webrev")
+                                            .webrevStorageBase(Path.of("test"))
+                                            .webrevStorageBaseUri(webrevServer.uri())
+                                            .webrevGenerateHTML(false)
+                                            .webrevGenerateJSON(true)
+                                            .readyLabels(Set.of("rfr"))
+                                            .readyComments(Map.of(ignored.forge().currentUser().userName(), Pattern.compile("ready")))
+                                            .issueTracker(URIBuilder.base("http://issues.test/browse/").build())
+                                            .headers(Map.of("Extra1", "val1", "Extra2", "val2"))
+                                            .sendInterval(Duration.ZERO)
+                                            .build();
+
+            // Populate the projects repository
+            var localRepo = CheckableRepository.init(tempFolder.path(), author.repositoryType());
+            var masterHash = localRepo.resolve("master").orElseThrow();
+            localRepo.push(masterHash, author.url(), "master", true);
+            localRepo.push(masterHash, archive.url(), "webrev", true);
+
+            // Make a change with a corresponding PR
+            var editHash = CheckableRepository.appendAndCommit(localRepo, "A simple change",
+                                                               "Change msg\n\nWith several lines");
+            localRepo.push(editHash, author.url(), "edit", true);
+            var pr = credentials.createPullRequest(archive, "master", "edit", "1234: This is a pull request");
+            pr.setBody("This should not be ready");
+
+            // Run an archive pass
+            TestBotRunner.runPeriodicItems(mlBot);
+
+            // A PR that isn't ready for review should not be archived
+            Repository.materialize(archiveFolder.path(), archive.url(), "master");
+            assertFalse(archiveContains(archiveFolder.path(), "This is a pull request"));
+
+            // Flag it as ready for review
+            pr.setBody("This should now be ready");
+            pr.addLabel("rfr");
+
+            // Run another archive pass
+            TestBotRunner.runPeriodicItems(mlBot);
+
+            // But it should still not be archived
+            Repository.materialize(archiveFolder.path(), archive.url(), "master");
+            assertFalse(archiveContains(archiveFolder.path(), "This is a pull request"));
+
+            // Now post a general comment - not a ready marker
+            var ignoredPr = ignored.pullRequest(pr.id());
+            ignoredPr.addComment("hello there");
+
+            // Run another archive pass
+            TestBotRunner.runPeriodicItems(mlBot);
+
+            // It should still not be archived
+            Repository.materialize(archiveFolder.path(), archive.url(), "master");
+            assertFalse(archiveContains(archiveFolder.path(), "This is a pull request"));
+
+            // Now post a ready comment
+            ignoredPr.addComment("ready");
+
+            // Run another archive pass
+            TestBotRunner.runPeriodicItems(mlBot);
+
+            // The archive should now contain an entry
+            Repository.materialize(archiveFolder.path(), archive.url(), "master");
+            assertTrue(archiveContains(archiveFolder.path(), "This is a pull request"));
+            assertTrue(archiveContains(archiveFolder.path(), "This should now be ready"));
+            assertTrue(archiveContains(archiveFolder.path(), "Patch:"));
+            assertTrue(archiveContains(archiveFolder.path(), "Changes:"));
+            assertTrue(archiveContains(archiveFolder.path(), "Webrev:"));
+            assertTrue(archiveContains(archiveFolder.path(), webrevServer.uri().toString()));
+            assertTrue(archiveContains(archiveFolder.path(), "&pr=" + pr.id() + "&range=00"));
+            assertTrue(archiveContains(archiveFolder.path(), "Issue:"));
+            assertTrue(archiveContains(archiveFolder.path(), "http://issues.test/browse/TSTPRJ-1234"));
+            assertTrue(archiveContains(archiveFolder.path(), "Fetch:"));
+            assertTrue(archiveContains(archiveFolder.path(), "^ - Change msg"));
+            assertFalse(archiveContains(archiveFolder.path(), "With several lines"));
+
+            // The mailing list as well
+            listServer.processIncoming();
+            var mailmanServer = MailingListServerFactory.createMailmanServer(listServer.getArchive(), listServer.getSMTP(), Duration.ZERO);
+            var mailmanList = mailmanServer.getList(listAddress.address());
+            var conversations = mailmanList.conversations(Duration.ofDays(1));
+            assertEquals(1, conversations.size());
+            var mail = conversations.get(0).first();
+            assertEquals("RFR: 1234: This is a pull request", mail.subject());
+            assertEquals(pr.author().fullName(), mail.author().fullName().orElseThrow());
+            assertEquals(noreplyAddress(archive), mail.author().address());
+            assertEquals(listAddress, mail.sender());
+            assertEquals("val1", mail.headerValue("Extra1"));
+            assertEquals("val2", mail.headerValue("Extra2"));
+
+            // And there should be a JSON version of a webrev
+            Repository.materialize(webrevFolder.path(), archive.url(), "webrev");
+            var jsonDir = webrevFolder.path()
+                                      .resolve(author.name())
+                                      .resolve(pr.id())
+                                      .resolve("00");
+            assertTrue(Files.exists(jsonDir));
+            assertTrue(Files.isDirectory(jsonDir));
+
+            var commitsFile = jsonDir.resolve("commits.json");
+            assertTrue(Files.exists(commitsFile));
+            var commits = JSON.parse(Files.readString(commitsFile));
+            assertEquals(1, commits.asArray().size());
+            var commit = commits.get(0);
+            assertEquals(editHash.hex(), commit.get("sha").asString());
+            assertEquals("Change msg\n\nWith several lines", commit.get("commit").get("message").asString());
+            assertEquals(1, commit.get("files").asArray().size());
+
+            var metadataFile = jsonDir.resolve("metadata.json");
+            assertTrue(Files.exists(metadataFile));
+            var metadata = JSON.parse(Files.readString(metadataFile));
+            assertEquals(masterHash.hex(), metadata.get("base").get("sha").asString());
+            assertEquals(editHash.hex(), metadata.get("head").get("sha").asString());
+
+            var comparisonFile = jsonDir.resolve("comparison.json");
+            assertTrue(Files.exists(comparisonFile));
+            var comparsion = JSON.parse(Files.readString(comparisonFile));
+            assertEquals(1, comparsion.get("files").asArray().size());
+            assertEquals("modified", comparsion.get("files").get(0).get("status").asString());
+            assertTrue(comparsion.get("files").get(0).get("patch").asString().contains("A simple change"));
+
+            var comments = pr.comments();
+            var webrevComments = comments.stream()
+                                         .filter(comment -> comment.author().equals(author.forge().currentUser()))
+                                         .filter(comment -> comment.body().contains("webrev"))
+                                         .filter(comment -> comment.body().contains(editHash.hex()))
+                                         .collect(Collectors.toList());
+            assertEquals(1, webrevComments.size());
+            var comment = webrevComments.get(0);
+            assertTrue(comment.body().contains("&pr=" + pr.id()));
+            assertTrue(comment.body().contains("&range=00"));
+
+            // Add a comment
+            pr.addComment("This is a comment :smile:");
+
+            // Add a comment from an ignored user as well
+            ignoredPr.addComment("Don't mind me");
+
+            // Run another archive pass
+            TestBotRunner.runPeriodicItems(mlBot);
+
+            // The archive should now contain the comment, but not the ignored one
+            Repository.materialize(archiveFolder.path(), archive.url(), "master");
+            assertTrue(archiveContains(archiveFolder.path(), "This is a comment"));
+            assertTrue(archiveContains(archiveFolder.path(), "> This should now be ready"));
+            assertFalse(archiveContains(archiveFolder.path(), "Don't mind me"));
+
+            listServer.processIncoming();
+            conversations = mailmanList.conversations(Duration.ofDays(1));
+            assertEquals(1, conversations.size());
+            assertEquals(2, conversations.get(0).allMessages().size());
+
+            // Remove the rfr flag and post another comment
+            pr.addLabel("rfr");
+            pr.addComment("This is another comment");
+
+            // Run another archive pass
+            TestBotRunner.runPeriodicItems(mlBot);
+
+            // The archive should contain the additional comment
+            Repository.materialize(archiveFolder.path(), archive.url(), "master");
+            assertTrue(archiveContains(archiveFolder.path(), "This is another comment"));
+            assertTrue(archiveContains(archiveFolder.path(), ">> This should now be ready"));
+
+            listServer.processIncoming();
+            conversations = mailmanList.conversations(Duration.ofDays(1));
+            assertEquals(1, conversations.size());
+            assertEquals(3, conversations.get(0).allMessages().size());
+            for (var newMail : conversations.get(0).allMessages()) {
+                assertEquals(noreplyAddress(archive), newMail.author().address());
+                assertEquals(listAddress, newMail.sender());
+            }
+            assertTrue(conversations.get(0).allMessages().get(2).body().contains("This is a comment 😄"));
+        }
+    }
 }
